<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Portal Pembelajaran Statistika</title>
<style>
  /* Reset CSS */
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  /* Body Layout */
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    height: 100vh;
    display: grid;
    grid-template-columns: 300px 1fr;
    grid-template-rows: 120px 1fr 60px;
    grid-template-areas:
      "profile header"
      "materials page"
      "footer footer";
    overflow: hidden; /* Prevent body scroll when content overflows */
  }

  /* Profile Section */
  .profile {
    grid-area: profile;
    background: linear-gradient(135deg, #4a90e2, #7bb3f0);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 20px;
    position: relative;
  }

  .author-photo {
    width: 80px;
    height: 80px;
    background-color: #1a1a1a;
    border-radius: 50%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    color: white;
    font-size: 12px;
    font-weight: bold;
    text-align: center;
    line-height: 1.2;
    border: 3px solid white;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  }

  /* Header */
  .header {
    grid-area: header;
    background: linear-gradient(135deg, #00bcd4, #26c6da);
    color: #004d5c;
    padding: 30px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    position: relative;
    /* Removed box-shadow to prevent any perceived outline */
    /* box-shadow: 0 4px 12px rgba(0,0,0,0.1); */
  }

  .header h1 {
    font-size: 28px;
    font-weight: 800;
    margin-bottom: 8px;
    /* Ensure no text-shadow or outline */
    text-shadow: none;
    outline: none;
  }

  .header p {
    font-size: 16px;
    font-weight: 500;
    opacity: 0.9;
    /* Ensure no text-shadow or outline */
    text-shadow: none;
    outline: none;
  }

  /* Materials Sidebar */
  .materials {
    grid-area: materials;
    background: linear-gradient(180deg, #e3f2fd, #bbdefb);
    border-right: 3px solid #2196f3;
    padding: 20px;
    overflow-y: auto;
    font-size: 14px;
    line-height: 1.5;
  }

  .materials-title {
    background: linear-gradient(135deg, #8bc34a, #9ccc65);
    padding: 12px;
    font-weight: bold;
    font-size: 16px;
    color: #2e7d32;
    text-align: center;
    border-radius: 8px;
    margin-bottom: 16px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }

  .material-item {
    margin-bottom: 12px;
    padding: 12px;
    background: rgba(255,255,255,0.7);
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.3s ease;
    border-left: 4px solid transparent;
    position: relative; /* Added for edit button */
  }

  .material-item:hover {
    background: rgba(255,255,255,0.9);
    border-left-color: #2196f3;
    transform: translateX(4px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  }

  .material-item.active {
    background: linear-gradient(135deg, #e8f5e8, #c8e6c9);
    border-left-color: #4caf50;
    font-weight: bold;
  }

  .material-subtitle {
    margin-left: 16px;
    margin-top: 8px;
    font-size: 13px;
    color: #555;
    font-style: italic;
  }

  /* Page Content */
  .page {
    grid-area: page;
    background: linear-gradient(135deg, #fafafa, #f5f5f5);
    padding: 30px;
    overflow-y: auto;
    position: relative;
    min-height: 500px;
  }

  .page-content {
    background: white;
    border-radius: 12px;
    padding: 30px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.1);
    min-height: 400px;
  }

  .page-content h2 {
    color: #1976d2;
    font-size: 24px;
    margin-bottom: 20px;
    border-bottom: 3px solid #e3f2fd;
    padding-bottom: 10px;
  }

  .page-content h3 {
    color: #388e3c;
    font-size: 18px;
    margin: 20px 0 12px 0;
  }

  .page-content p {
    color: #424242;
    line-height: 1.6;
    text-align: justify;
    margin-bottom: 16px;
  }

  .page-content ul {
    margin-left: 20px;
    margin-bottom: 16px;
  }

  .page-content li {
    margin-bottom: 8px;
    color: #555;
  }

  .references {
    background: #f8f9fa;
    border-left: 4px solid #2196f3;
    padding: 16px;
    margin-top: 30px;
    border-radius: 0 8px 8px 0;
  }

  .references h4 {
    color: #1976d2;
    margin-bottom: 12px;
  }

  .references ol {
    margin-left: 20px;
    font-size: 13px;
    color: #666;
  }

  /* Footer */
  .footer {
    grid-area: footer;
    background: linear-gradient(135deg, #1976d2, #2196f3);
    color: white;
    padding: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 14px;
    /* Removed box-shadow to prevent any perceived outline */
    /* box-shadow: 0 -4px 12px rgba(0,0,0,0.1); */
  }

  .footer-left {
    display: flex;
    gap: 30px;
  }

  .footer-item {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .footer-item strong {
    font-weight: 600;
  }

  .footer-item span {
    /* Ensure no text-shadow or outline */
    text-shadow: none;
    outline: none;
  }

  /* Help & FAQ Button */
  .help-faq-btn {
    position: fixed;
    bottom: 80px;
    right: 30px;
    background: linear-gradient(135deg, #3f51b5, #5c6bc0);
    color: white;
    width: 50px; /* Adjusted width for icon */
    height: 50px; /* Adjusted height */
    border-radius: 50%; /* Circular shape for icon */
    border: none;
    cursor: grab; /* Cursor to indicate draggable */
    font-size: 24px; /* Icon size */
    font-weight: bold;
    text-align: center;
    box-shadow: 0 6px 20px rgba(63,81,181,0.4);
    transition: all 0.3s ease;
    z-index: 1000;
    display: flex;
    align-items: center;
    justify-content: center;
    touch-action: none; /* Prevent default touch actions */
  }

  .help-faq-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 8px 25px rgba(63,81,181,0.6);
  }

  .help-faq-btn svg {
    fill: white;
    width: 24px;
    height: 24px;
  }

  /* Analysis Tools Section */
  .analysis-tools {
    background: #e8f5e8;
    border: 2px solid #4caf50;
    border-radius: 8px;
    padding: 20px;
    margin-top: 20px;
  }

  .analysis-tools h3 {
    color: #2e7d32;
    margin-bottom: 16px;
    text-align: center;
  }

  .tools-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 12px;
  }

  .tool-btn {
    background: linear-gradient(135deg, #66bb6a, #81c784);
    color: white;
    border: none;
    padding: 12px 8px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 12px;
    font-weight: bold;
    transition: all 0.3s ease;
    text-align: center;
  }

  .tool-btn:hover {
    background: linear-gradient(135deg, #4caf50, #66bb6a);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(76,175,80,0.3);
  }

  /* Form styling for analysis tools */
  .analysis-form {
    background: #fff;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    margin-top: 20px;
  }

  .form-group {
    margin-bottom: 16px;
  }

  .form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: bold;
    color: #333;
  }

  .form-group input[type="text"],
  .form-group input[type="number"],
  .form-group input[type="file"],
  .form-group select,
  .form-group textarea {
    width: 100%;
    padding: 10px;
    border: 2px solid #e0e0e0;
    border-radius: 4px;
    font-size: 14px;
    transition: border-color 0.3s ease;
  }

  .form-group input[type="file"] {
    padding: 5px;
  }

  .form-group input:focus,
  .form-group select:focus,
  .form-group textarea:focus {
    outline: none;
    border-color: #2196f3;
  }

  .btn-primary {
    background: linear-gradient(135deg, #2196f3, #42a5f5);
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: bold;
    transition: all 0.3s ease;
  }

  .btn-primary:hover {
    background: linear-gradient(135deg, #1976d2, #2196f3);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(33,150,243,0.3);
  }

  /* Admin Mode Styles */
  .admin-mode-toggle {
    position: fixed;
    top: 20px;
    right: 20px;
    background: linear-gradient(135deg, #2196f3, #42a5f5); /* Changed to blue gradient */
    color: white;
    padding: 10px 15px;
    border-radius: 5px;
    cursor: grab; /* Cursor to indicate draggable */
    font-weight: bold;
    z-index: 1001;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.3s ease;
    touch-action: none; /* Prevent default touch actions */
  }

  .admin-mode-toggle:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(33,150,243,0.3);
  }

  .admin-mode-toggle.active {
    background: linear-gradient(135deg, #f44336, #ef5350); /* Red when active */
  }
  .admin-mode-toggle.active:hover {
    background: linear-gradient(135deg, #d32f2f, #f44336);
  }

  /* Admin Login Section */
  .admin-login-section {
    position: fixed;
    top: 60px;
    right: 20px;
    background-color: #f0f0f0;
    padding: 10px;
    border-radius: 5px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    z-index: 1001;
    display: none; /* Hidden by default */
    flex-direction: column;
    gap: 10px;
  }

  body.admin-active .admin-login-section {
    display: flex; /* Changed to flex to stack elements */
  }

  .admin-login-section .form-group {
    margin-bottom: 0; /* Remove extra margin */
  }

  .admin-login-section label {
    margin-right: 5px;
    font-weight: bold;
    display: block; /* Make label take full width */
    margin-bottom: 5px;
  }

  .admin-login-section input[type="password"] {
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 3px;
    width: calc(100% - 16px); /* Adjust width for padding */
    margin-bottom: 5px;
  }

  .admin-login-section button {
    padding: 8px 12px;
    border: none;
    border-radius: 3px;
    background-color: #2196f3;
    color: white;
    cursor: pointer;
    width: 100%; /* Make button take full width */
  }

  .admin-login-section button:hover {
    background-color: #1976d2;
  }

  .editable-content {
    /* Default styles for editable content */
    border: none; /* No border by default */
    padding: 0; /* No padding by default */
    min-height: auto; /* Auto height by default */
  }

  /* Styles for editable content when admin mode is active */
  body.admin-active .editable-content {
    border: 1px dashed #ff9800; /* Dashed border in admin mode */
    padding: 5px;
    min-height: 1.5em;
  }

  .editable-content:hover {
    background-color: #f0f0f0;
  }

  .admin-controls {
    margin-top: 20px;
    padding: 15px;
    background-color: #fff3e0;
    border-left: 5px solid #ff9800;
    display: none; /* Hidden by default */
  }

  body.admin-active .admin-controls {
    display: block;
  }

  .admin-controls button {
    margin-right: 10px;
    padding: 8px 15px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-weight: bold;
  }

  .admin-controls .save-btn {
    background-color: #4CAF50;
    color: white;
  }

  .admin-controls .cancel-btn {
    background-color: #f44336;
    color: white;
  }

  .admin-controls .add-material-btn {
    background-color: #2196f3;
    color: white;
  }

  .material-item .edit-btn, .material-item .delete-btn {
    position: absolute;
    top: 5px;
    right: 5px;
    background-color: #2196f3;
    color: white;
    border: none;
    border-radius: 3px;
    padding: 3px 6px;
    font-size: 10px;
    cursor: pointer;
    display: none; /* Hidden by default */
    margin-left: 5px;
  }

  .material-item .delete-btn {
    right: 45px; /* Adjust position for delete button */
    background-color: #f44336;
  }

  body.admin-active .material-item .edit-btn,
  body.admin-active .material-item .delete-btn {
    display: block;
  }

  /* Help/FAQ Modal */
  .help-faq-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1002;
    visibility: hidden;
    opacity: 0;
    transition: visibility 0s, opacity 0.3s ease;
  }

  .help-faq-modal.open {
    visibility: visible;
    opacity: 1;
  }

  .help-faq-content {
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.3);
    width: 90%;
    max-width: 600px;
    max-height: 90%;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  .help-faq-header {
    background: linear-gradient(135deg, #3f51b5, #5c6bc0);
    color: white;
    padding: 15px 20px;
    border-top-left-radius: 10px;
    border-top-right-radius: 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-weight: bold;
    font-size: 1.2em;
  }

  .help-faq-header .close-btn {
    background: none;
    border: none;
    color: white;
    font-size: 1.5em;
    cursor: pointer;
    line-height: 1;
  }

  .help-faq-body {
    flex-grow: 1;
    padding: 20px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
  }

  /* Chatbot Styles within Modal */
  .chatbot-container-modal {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    border: 1px solid #eee;
    border-radius: 8px;
    overflow: hidden;
    margin-top: 15px;
  }

  .chatbot-header {
    background-color: #f0f0f0;
    padding: 10px;
    font-weight: bold;
    border-bottom: 1px solid #eee;
  }

  .chatbot-messages {
    flex-grow: 1;
    padding: 10px;
    overflow-y: auto;
    background-color: #e3f2fd;
    display: flex; /* Enable flex for messages */
    flex-direction: column; /* Stack messages vertically */
  }

  .chatbot-message {
    margin-bottom: 10px;
    padding: 8px 12px;
    border-radius: 15px;
    max-width: 80%;
    word-wrap: break-word;
  }

  .chatbot-message.user {
    background-color: #dcf8c6;
    align-self: flex-end;
    margin-left: auto;
  }

  .chatbot-message.bot {
    background-color: #f1f0f0;
    align-self: flex-start;
    margin-right: auto;
  }

  .chatbot-input {
    display: flex;
    padding: 10px;
    border-top: 1px solid #eee;
    background-color: #f9f9f9;
  }

  .chatbot-input input {
    flex-grow: 1;
    border: 1px solid #ccc;
    border-radius: 20px;
    padding: 8px 12px;
    margin-right: 10px;
  }

  .chatbot-input button {
    background: #5c6bc0;
    color: white;
    border: none;
    border-radius: 20px;
    padding: 8px 15px;
    cursor: pointer;
    transition: background-color 0.2s ease;
  }
  .chatbot-input button:hover {
    background-color: #3f51b5;
  }

  /* Responsive untuk mobile */
  @media (max-width: 768px) {
    body {
      grid-template-columns: 1fr;
      grid-template-rows: auto auto 1fr auto;
      grid-template-areas:
        "profile"
        "header"
        "page"
        "footer";
    }
    
    .materials {
      display: none;
    }

    .admin-mode-toggle {
        top: 10px;
        right: 10px;
        padding: 8px 12px;
        font-size: 10px;
    }

    .admin-login-section {
        top: 50px;
        right: 10px;
        width: calc(100% - 20px);
        max-width: 300px;
    }

    .help-faq-btn {
      bottom: 20px;
      right: 20px;
      width: 40px;
      height: 40px;
      font-size: 12px;
      border-radius: 50%;
    }

    .help-faq-modal {
      padding: 10px;
    }

    .help-faq-content {
      width: 100%;
      max-width: unset;
      max-height: 95%;
    }

    .help-faq-header {
      font-size: 1em;
      padding: 10px 15px;
    }

    .help-faq-header .close-btn {
      font-size: 1.2em;
    }

    .help-faq-body {
      padding: 15px;
    }
  }
</style>
</head>
<body>

  <!-- Admin Mode Toggle Button -->
  <button class="admin-mode-toggle" id="admin-mode-toggle-btn" onclick="toggleAdminMode()">
    Login
  </button>

  <!-- Admin Login/Logout Section -->
  <div class="admin-login-section" id="admin-login-section">
    <div id="admin-login-form">
      <div class="form-group">
        <label for="admin-password">Password:</label>
        <input type="password" id="admin-password" placeholder="Masukkan password"/>
      </div>
      <button onclick="loginAdmin()">Login</button>
    </div>
    <div id="admin-logout-form" style="display: none;">
      <p>Mode Admin Aktif</p>
      <button onclick="logoutAdmin()">Logout</button>
    </div>
  </div>

  <!-- Profile Section -->
  <div class="profile">
    <div class="author-photo">
      Author<br/>Foto<br/>Profile
    </div>
  </div>

  <!-- Header -->
  <header class="header">
    <h1 class="editable-content" data-editable-id="header-title">Portal Pembelajaran Statistika</h1>
    <p class="editable-content" data-editable-id="header-subtitle">Platform komprehensif untuk belajar dan menganalisis data statistik</p>
  </header>

  <!-- Materials Sidebar -->
  <nav class="materials">
    <div class="materials-title editable-content" data-editable-id="materials-sidebar-title">Materials</div>
    
    <div class="material-item" data-material-id="1" onclick="showMaterial(1)">
      <strong class="editable-content" data-editable-id="material-title-1">1. Pengantar Statistika</strong>
      <div class="material-subtitle editable-content" data-editable-id="material-subtitle-1">Sejarah, arti, peran, populasi, sampel, teknik sampling, parameter dan statistik</div>
      <button class="edit-btn" onclick="editMaterial(1, event)">Edit</button>
      <button class="delete-btn" onclick="deleteMaterial(1, event)">Hapus</button>
    </div>

    <div class="material-item" data-material-id="2" onclick="showMaterial(2)">
      <strong class="editable-content" data-editable-id="material-title-2">2. Statistika Deskriptif</strong>
      <div class="material-subtitle editable-content" data-editable-id="material-subtitle-2">Penyajian data, ukuran pemusatan, ukuran penyebaran</div>
      <button class="edit-btn" onclick="editMaterial(2, event)">Edit</button>
      <button class="delete-btn" onclick="deleteMaterial(2, event)">Hapus</button>
    </div>

    <div class="material-item" data-material-id="3" onclick="showMaterial(3)">
      <strong class="editable-content" data-editable-id="material-title-3">3. Statistika Inferensial</strong>
      <div class="material-subtitle editable-content" data-editable-id="material-subtitle-3">Distribusi peluang, uji hipotesis, parametrik, non-parametrik</div>
      <button class="edit-btn" onclick="editMaterial(3, event)">Edit</button>
      <button class="delete-btn" onclick="deleteMaterial(3, event)">Hapus</button>
    </div>

    <div class="material-item" data-material-id="4" onclick="showMaterial(4)">
      <strong class="editable-content" data-editable-id="material-title-4">4. Probabilitas dan Distribusi</strong>
      <div class="material-subtitle editable-content" data-editable-id="material-subtitle-4">Konsep dasar probabilitas, distribusi diskrit dan kontinu</div>
      <button class="edit-btn" onclick="editMaterial(4, event)">Edit</button>
      <button class="delete-btn" onclick="deleteMaterial(4, event)">Hapus</button>
    </div>

    <div class="material-item" data-material-id="5" onclick="showMaterial(5)">
      <strong class="editable-content" data-editable-id="material-title-5">5. Teori Statistika Lanjut</strong>
      <div class="material-subtitle editable-content" data-editable-id="material-subtitle-5">GLM, Non-Linear Model, Bayesian</div>
      <button class="edit-btn" onclick="editMaterial(5, event)">Edit</button>
      <button class="delete-btn" onclick="deleteMaterial(5, event)">Hapus</button>
    </div>

    <div class="material-item" data-material-id="6" onclick="showMaterial(6)">
      <strong class="editable-content" data-editable-id="material-title-6">6. Penerapan Statistika</strong>
      <div class="material-subtitle editable-content" data-editable-id="material-subtitle-6">Komputer, AI, sains data, big data</div>
      <button class="edit-btn" onclick="editMaterial(6, event)">Edit</button>
      <button class="delete-btn" onclick="deleteMaterial(6, event)">Hapus</button>
    </div>

    <div class="material-item" data-material-id="7" onclick="showMaterial(7)">
      <strong class="editable-content" data-editable-id="material-title-7">7. Materi Lainnya</strong>
      <div class="material-subtitle editable-content" data-editable-id="material-subtitle-7">Topik tambahan dan pengembangan</div>
      <button class="edit-btn" onclick="editMaterial(7, event)">Edit</button>
      <button class="delete-btn" onclick="deleteMaterial(7, event)">Hapus</button>
    </div>

    <div class="material-item" data-material-id="8" onclick="showMaterial(8)">
      <strong class="editable-content" data-editable-id="material-title-8">8. AnalysisTools</strong>
      <div class="material-subtitle editable-content" data-editable-id="material-subtitle-8">Tools analisis data statistik interaktif</div>
      <button class="edit-btn" onclick="editMaterial(8, event)">Edit</button>
      <button class="delete-btn" onclick="deleteMaterial(8, event)">Hapus</button>
    </div>

    <div class="admin-controls">
      <button class="add-material-btn" onclick="addNewMaterial()">+ Tambah Materi Baru</button>
    </div>
  </nav>

  <!-- Main Content Page -->
  <main class="page">
    <div class="page-content" id="pageContent">
      <h2 class="editable-content" data-editable-id="welcome-title">Selamat Datang di Portal Pembelajaran Statistika</h2>
      <p class="editable-content" data-editable-id="welcome-text">Pilih materi dari menu di sebelah kiri untuk memulai pembelajaran atau akses tools analisis statistik.</p>
      
      <h3 class="editable-content" data-editable-id="about-platform-title">Tentang Platform Ini</h3>
      <p class="editable-content" data-editable-id="about-platform-text">Platform ini dirancang untuk membantu mahasiswa, peneliti, dan praktisi dalam memahami konsep statistika serta melakukan analisis data dengan mudah dan akurat.</p>
      
      <h3 class="editable-content" data-editable-id="main-features-title">Fitur Utama</h3>
      <ul class="editable-content" data-editable-id="main-features-list">
        <li>Materi pembelajaran statistika yang komprehensif</li>
        <li>Tools analisis data interaktif</li>
        <li>Contoh kasus dan studi aplikasi</li>
        <li>Referensi akademik yang valid</li>
      </ul>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-left">
      <div class="footer-item">
        <strong>📍</strong>
        <span class="editable-content" data-editable-id="footer-address">Jl. Statistika No. 123, Jakarta 12345</span>
      </div>
      <div class="footer-item">
        <strong>📞</strong>
        <span class="editable-content" data-editable-id="footer-phone">(021) 1234-5678</span>
      </div>
      <div class="footer-item">
        <strong>✉️</strong>
        <span class="editable-content" data-editable-id="footer-email">konsultasi@statistika.ac.id</span>
      </div>
    </div>
    <div class="editable-content" data-editable-id="footer-copyright">© 2024 Portal Pembelajaran Statistika</div>
  </footer>

  <!-- Help & FAQ Button (Draggable) -->
  <button class="help-faq-btn" id="help-faq-btn" onclick="toggleHelpFAQModal()">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
      <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM7 9h2v2H7V9zm4 0h2v2h-2V9zm4 0h2v2h-2V9z"/>
    </svg>
  </button>

  <!-- Help & FAQ Modal (contains Chatbot) -->
  <div class="help-faq-modal" id="help-faq-modal">
    <div class="help-faq-content">
      <div class="help-faq-header">
        <span>Bantuan & FAQ</span>
        <button class="close-btn" onclick="toggleHelpFAQModal()">×</button>
      </div>
      <div class="help-faq-body">
        <h3>Pertanyaan Umum (FAQ)</h3>
        <p>Di sini Anda dapat menemukan jawaban atas pertanyaan yang sering diajukan. Jika Anda tidak menemukan jawaban, silakan gunakan chatbot di bawah ini.</p>
        <ul>
          <li><strong>Apa itu Statistika?</strong> Statistika adalah ilmu yang berkaitan dengan pengumpulan, pengorganisasian, analisis, interpretasi, dan presentasi data.</li>
          <li><strong>Bagaimana cara menggunakan Analysis Tools?</strong> Pilih tool yang Anda inginkan dari menu, masukkan data, dan klik 'Analisis'.</li>
          <li><strong>Apakah saya bisa mengunduh materi?</strong> Saat ini fitur unduh belum tersedia, namun Anda bisa menyalin teks materi.</li>
        </ul>

        <div class="chatbot-container-modal">
          <div class="chatbot-header">
            <span>Statistika Chatbot</span>
          </div>
          <div class="chatbot-messages" id="chatbot-messages">
            <div class="chatbot-message bot">Halo! Saya Chatbot Statistika. Ada yang bisa saya bantu?</div>
          </div>
          <div class="chatbot-input">
            <input type="text" id="chatbot-input-field" placeholder="Ketik pesan Anda..." onkeypress="handleChatInput(event)"/>
            <button onclick="sendChatMessage()">Kirim</button>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
  let isAdminMode = false;
  let currentEditableContent = null; // To store the currently edited element
  let originalContent = ''; // To store original content before editing
  const ADMIN_PASSWORD = '12345'; // Password standar untuk admin
  const LOCAL_STORAGE_PREFIX = 'webstat_'; // Prefix for local storage keys

  // Helper functions for local storage
  function saveToLocalStorage(key, value) {
    localStorage.setItem(LOCAL_STORAGE_PREFIX + key, JSON.stringify(value));
  }

  function loadFromLocalStorage(key) {
    const stored = localStorage.getItem(LOCAL_STORAGE_PREFIX + key);
    return stored ? JSON.parse(stored) : null;
  }

  // Konten untuk setiap materi (sekarang disimpan dalam objek global)
  // Ini akan menjadi sumber kebenaran untuk konten yang dapat diedit
  let materialContents = {
    1: {
      title: "1. Pengantar Statistika",
      subtitle: "Sejarah, arti, peran, populasi, sampel, teknik sampling, parameter dan statistik",
      content: `
        <h2>1. Pengantar Statistika</h2>
        
        <h3>Sejarah Statistika</h3>
        <p>Statistika sebagai ilmu berkembang dari kebutuhan praktis untuk mengumpulkan dan menganalisis data. Awalnya digunakan untuk keperluan administrasi negara (state arithmetic), statistika kini telah berkembang menjadi ilmu yang fundamental dalam penelitian ilmiah dan pengambilan keputusan berbasis data.</p>
        
        <p>Perkembangan statistika dimulai dari:</p>
        <ul>
          <li><strong>Abad 17:</strong> John Graunt - analisis data kematian London</li>
          <li><strong>Abad 18:</strong> Thomas Bayes - teorema Bayes</li>
          <li><strong>Abad 19:</strong> Carl Friedrich Gauss - distribusi normal</li>
          <li><strong>Abad 20:</strong> Ronald Fisher - ANOVA dan desain eksperimen</li>
        </ul>
        
        <h3>Arti dan Peran Statistika</h3>
        <p>Statistika adalah ilmu yang berkaitan dengan pengumpulan, pengorganisasian, analisis, interpretasi, dan presentasi data. Statistika memainkan peran penting dalam:</p>
        <ul>
          <li>Pengambilan keputusan berdasarkan data empiris</li>
          <li>Penelitian ilmiah dan metodologi eksperimen</li>
          <li>Analisis tren, pola, dan prediksi masa depan</li>
          <li>Kontrol kualitas dalam industri dan layanan</li>
          <li>Kebijakan publik berdasarkan evidensi</li>
        </ul>
        
        <h3>Populasi, Sampel, dan Teknik Sampling</h3>
        <p><strong>Populasi</strong> adalah keseluruhan objek atau individu yang menjadi sasaran penelitian atau yang memiliki karakteristik tertentu yang ingin dipelajari. <strong>Sampel</strong> adalah bagian dari populasi yang dipilih untuk diteliti sebagai representasi populasi.</p>
        
        <p><strong>Teknik Sampling Probabilitas:</strong></p>
        <ul>
          <li><strong>Simple Random Sampling:</strong> Setiap anggota populasi memiliki peluang sama untuk terpilih</li>
          <li><strong>Stratified Sampling:</strong> Populasi dibagi strata, kemudian diambil sampel dari setiap strata</li>
          <li><strong>Cluster Sampling:</strong> Populasi dibagi cluster, beberapa cluster dipilih secara acak</li>
          <li><strong>Systematic Sampling:</strong> Pemilihan sampel dengan interval tetap</li>
        </ul>
        
        <p><strong>Teknik Sampling Non-Probabilitas:</strong></p>
        <ul>
          <li><strong>Convenience Sampling:</strong> Sampel mudah diakses</li>
          <li><strong>Purposive Sampling:</strong> Sampel dipilih berdasarkan kriteria tertentu</li>
          <li><strong>Quota Sampling:</strong> Sampel berdasarkan kuota yang telah ditentukan</li>
          <li><strong>Snowball Sampling:</strong> Sampel diperoleh melalui referensi responden</li>
        </ul>
        
        <h3>Parameter dan Statistik</h3>
        <p><strong>Parameter</strong> adalah ukuran yang menggambarkan karakteristik populasi (biasanya tidak diketahui dan dilambangkan dengan huruf Yunani). <strong>Statistik</strong> adalah ukuran yang menggambarkan karakteristik sampel (dapat dihitung dari data sampel).</p>
        
        <p><strong>Contoh Parameter vs Statistik:</strong></p>
        <ul>
          <li>μ (mu) = rata-rata populasi vs x̄ = rata-rata sampel</li>
          <li>σ (sigma) = standar deviasi populasi vs s = standar deviasi sampel</li>
          <li>π (pi) = proporsi populasi vs p = proporsi sampel</li>
        </ul>
        
        <div class="references">
          <h4>Referensi</h4>
          <ol>
            <li>D. C. Montgomery and G. C. Runger, "Applied Statistics and Probability for Engineers," 7th ed., Wiley, 2018.</li>
            <li>R. E. Walpole et al., "Probability & Statistics for Engineers & Scientists," 9th ed., Pearson, 2016.</li>
            <li>J. L. Devore, "Probability and Statistics for Engineering and the Sciences," 9th ed., Cengage, 2015.</li>
            <li>W. Mendenhall et al., "Introduction to Probability and Statistics," 15th ed., Cengage, 2020.</li>
          </ol>
        </div>
      `
    },
    2: {
      title: "2. Statistika Deskriptif",
      subtitle: "Penyajian data, ukuran pemusatan, ukuran penyebaran",
      content: `
        <h2>2. Statistika Deskriptif</h2>
        
        <h3>Pengertian Statistika Deskriptif</h3>
        <p>Statistika deskriptif adalah cabang statistika yang berkaitan dengan pengumpulan, penyajian, dan peringkasan data untuk memberikan informasi yang berguna tentang data tersebut. Tujuan utamanya adalah menggambarkan karakteristik data tanpa membuat kesimpulan yang melampaui data yang tersedia.</p>
        
        <h3>Penyajian Data dalam Bentuk Tabel dan Grafik</h3>
        <p>Data dapat disajikan dalam berbagai bentuk untuk memudahkan pemahaman dan interpretasi:</p>
        
        <p><strong>Jenis-jenis Grafik:</strong></p>
        <ul>
          <li><strong>Bar Chart:</strong> Menampilkan data kategorikal dengan batang vertikal atau horizontal</li>
          <li><strong>Histogram:</strong> Menampilkan distribusi frekuensi data kontinu</li>
          <li><strong>Line Chart:</strong> Menampilkan trend data sepanjang waktu</li>
          <li><strong>Pie Chart:</strong> Menampilkan proporsi bagian dari keseluruhan</li>
          <li><strong>Polygon:</strong> Menghubungkan titik tengah histogram dengan garis</li>
          <li><strong>Ogive:</strong> Grafik frekuensi kumulatif</li>
          <li><strong>Scatter Plot:</strong> Menampilkan hubungan antara dua variabel kontinu</li>
          <li><strong>Box Plot:</strong> Menampilkan distribusi data melalui kuartil</li>
          <li><strong>Stem-and-Leaf:</strong> Menampilkan distribusi dengan mempertahankan nilai asli</li>
        </ul>
        
        <h3>Ukuran Pemusatan Data</h3>
        <p>Ukuran pemusatan memberikan informasi tentang nilai tengah atau pusat dari suatu distribusi data:</p>
        
        <ul>
          <li><strong>Mean (Rata-rata Aritmatika):</strong>
            <p>Formula: μ = Σxi/n (populasi) atau x̄ = Σxi/n (sampel)</p>
            <p>Kelebihan: Menggunakan semua data, mudah dihitung</p>
            <p>Kelemahan: Sensitif terhadap outlier</p>
          </li>
          <li><strong>Median:</strong>
            <p>Nilai tengah setelah data diurutkan dari terkecil ke terbesar</p>
            <p>Kelebihan: Tidak terpengaruh outlier</p>
            <p>Kelemahan: Tidak menggunakan semua informasi data</p>
          </li>
          <li><strong>Modus:</strong>
            <p>Nilai yang paling sering muncul dalam data</p>
            <p>Dapat digunakan untuk semua jenis data (nominal, ordinal, interval, rasio)</p>
          </li>
        </ul>
        
        <h3>Ukuran Penyebaran Data</h3>
        <p>Ukuran penyebaran menggambarkan seberapa tersebar atau bervariasi data dari pusat distribusi:</p>
        
        <ul>
          <li><strong>Range:</strong> Selisih antara nilai maksimum dan minimum</li>
          <li><strong>Varians:</strong>
            <p>σ² = Σ(xi-μ)²/N (populasi) atau s² = Σ(xi-x̄)²/(n-1) (sampel)</p>
          </li>
          <li><strong>Standar Deviasi:</strong>
            <p>σ = √σ² (populasi) atau s = √s² (sampel)</p>
          </li>
          <li><strong>Kuartil:</strong>
            <p>Q1 (kuartil pertama), Q2 (median), Q3 (kuartil ketiga)</p>
          </li>
          <li><strong>Interquartile Range (IQR):</strong> Q3 - Q1</li>
          <li><strong>Koefisien Variasi:</strong> CV = (σ/μ) × 100%</p>
          </li>
        </ul>
        
        <h3>Bentuk Distribusi Data</h3>
        <ul>
          <li><strong>Simetris:</strong> Data terdistribusi merata di sekitar pusat</li>
          <li><strong>Skewness Positif:</strong> Ekor distribusi memanjang ke kanan</li>
          <li><strong>Skewness Negatif:</strong> Ekor distribusi memanjang ke kiri</li>
          <li><strong>Kurtosis:</strong> Mengukur keruncingan distribusi</li>
        </ul>
        
        <div class="references">
          <h4>Referensi</h4>
          <ol>
            <li>A. Agresti and B. Finlay, "Statistical Methods for the Social Sciences," 5th ed., Pearson, 2014.</li>
            <li>D. S. Moore et al., "Introduction to the Practice of Statistics," 9th ed., W.H. Freeman, 2017.</li>
            <li>R. Lind et al., "Statistical Techniques in Business and Economics," 17th ed., McGraw-Hill, 2018.</li>
            <li>B. Render et al., "Quantitative Analysis for Management," 13th ed., Pearson, 2018.</li>
          </ol>
        </div>
      `
    },
    3: {
      title: "3. Statistika Inferensial",
      subtitle: "Distribusi peluang, uji hipotesis, parametrik, non-parametrik",
      content: `
        <h2>3. Statistika Inferensial</h2>
        
        <h3>Pengertian Statistika Inferensial</h3>
        <p>Statistika inferensial adalah cabang statistika yang berkaitan dengan penarikan kesimpulan tentang populasi berdasarkan informasi yang diperoleh dari sampel. Berbeda dengan statistika deskriptif, statistika inferensial memungkinkan kita membuat generalisasi dan prediksi.</p>
        
        <h3>Distribusi Peluang</h3>
        <p>Distribusi peluang adalah fondasi matematika untuk statistika inferensial yang menggambarkan bagaimana probabilitas terdistribusi over nilai-nilai yang mungkin dari suatu variabel random.</p>
        
        <p><strong>Distribusi Peluang Diskrit:</strong></p>
        <ul>
          <li><strong>Distribusi Binomial:</strong> B(n,p) - untuk eksperimen berulang dengan probabilitas sukses konstan</li>
          <li><strong>Distribusi Poisson:</strong> P(λ) - untuk kejadian langka dalam interval waktu/ruang tertentu</li>
          <li><strong>Distribusi Geometrik:</strong> untuk jumlah percobaan hingga sukses pertama</li>
          <li><strong>Distribusi Hipergeometrik:</strong> sampling tanpa pengembalian</li>
        </ul>
        
        <p><strong>Distribusi Peluang Kontinu:</strong></p>
        <ul>
          <li><strong>Distribusi Normal:</strong> N(μ,σ²) - distribusi simetrik berbentuk lonceng</li>
          <li><strong>Distribusi t-Student:</strong> untuk sampel kecil dengan σ tidak diketahui</li>
          <li><strong>Distribusi Chi-square (χ²):</strong> untuk uji varians dan goodness of fit</li>
          <li><strong>Distribusi F:</strong> untuk uji rasio dua varians</li>
          <li><strong>Distribusi Uniform:</strong> semua nilai dalam interval memiliki probabilitas sama</li>
        </ul>
        
        <h3>Pendugaan Parameter</h3>
        <p>Estimasi parameter populasi menggunakan statistik sampel:</p>
        
        <ul>
          <li><strong>Point Estimate:</strong>
            <p>Dugaan tunggal untuk parameter populasi (contoh: x̄ sebagai dugaan μ)</p>
          </li>
          <li><strong>Interval Estimate (Confidence Interval):</strong>
            <p>Rentang nilai yang memiliki probabilitas tertentu memuat parameter populasi</p>
            <p>CI = point estimate ± margin of error</p>
          </li>
        </ul>
        
        <h3>Konsep Uji Hipotesis</h3>
        <p>Uji hipotesis adalah prosedur statistik untuk menguji klaim atau asumsi tentang parameter populasi berdasarkan evidence dari sampel.</p>
        
        <p><strong>Komponen Uji Hipotesis:</strong></p>
        <ul>
          <li><strong>H₀ (Hipotesis Nol):</strong> Pernyataan yang diuji, biasanya "tidak ada efek" atau "tidak ada perbedaan"</li>
          <li><strong>H₁ atau Ha (Hipotesis Alternatif):</strong> Pernyataan yang akan diterima jika H₀ ditolak</li>
          <li><strong>α (Alpha):</strong> Tingkat signifikansi, probabilitas menolak H₀ yang benar (Type I error)</li>
          <li><strong>β (Beta):</strong> Probabilitas menerima H₀ yang salah (Type II error)</li>
          <li><strong>Power:</strong> 1-β, probabilitas menolak H₀ yang salah</li>
          <li><strong>p-value:</strong> Probabilitas mendapat hasil ekstrem atau lebih ekstrem jika H₀ benar</li>
        </ul>
        
        <h3>Jenis Uji Hipotesis</h3>
        <ul>
          <li><strong>Uji Deskriptif:</strong> Menguji karakteristik satu variabel (contoh: uji rata-rata satu sampel)</li>
          <li><strong>Uji Komparatif:</strong> Membandingkan antar kelompok (contoh: uji beda rata-rata dua kelompok)</li>
          <li><strong>Uji Asosiatif:</strong> Menguji hubungan antar variabel (contoh: uji korelasi, uji independensi)</li>
        </ul>
        
        <h3>Statistika Inferensial Parametrik</h3>
        <p>Metode yang mengasumsikan data mengikuti distribusi tertentu (biasanya normal):</p>
        <ul>
          <li><strong>Uji-t:</strong> One-sample, two-sample, paired t-test</li>
          <li><strong>ANOVA:</strong> One-way, two-way, repeated measures ANOVA</li>
          <li><strong>Uji Korelasi Pearson:</strong> Mengukur hubungan linear antar variabel</li>
          <li><strong>Regresi Linear:</strong> Memodelkan hubungan antar variabel</li>
        </ul>
        
        <h3>Statistika Inferensial Non-Parametrik</h3>
        <p>Metode yang tidak mengasumsikan distribusi tertentu, cocok untuk data tidak normal:</p>
        <ul>
          <li><strong>Uji Chi-square:</strong> Uji independensi dan goodness of fit</li>
          <li><strong>Uji Binomial:</strong> Untuk proporsi dalam sampel kecil</li>
          <li><strong>Uji Tanda:</strong> Membandingkan median dengan nilai tertentu</li>
          <li><strong>Uji Mann-Whitney (Wilcoxon Rank-Sum):</strong> Membandingkan dua kelompok independen</li>
          <li><strong>Uji Wilcoxon Signed-Rank:</strong> Untuk data berpasangan</li>
          <li><strong>Uji Kruskal-Wallis:</strong> Alternatif non-parametrik untuk one-way ANOVA</li>
        </ul>
        
        <h3>Uji Asumsi Klasik</h3>
        <p>Pengujian asumsi yang harus dipenuhi dalam analisis parametrik:</p>
        <ul>
          <li><strong>Uji Normalitas:</strong> Shapiro-Wilk, Kolmogorov-Smirnov, Anderson-Darling</li>
          <li><strong>Uji Homogenitas Varians:</strong> Levene's test, Bartlett's test</li>
          <li><strong>Uji Independensi:</strong> Durbin-Watson test untuk autokorelasi</li>
          <li><strong>Uji Linearitas:</strong> Untuk hubungan linear dalam regresi</li>
        </ul>
        
        <div class="references">
          <h4>Referensi</h4>
          <ol>
            <li>R. V. Hogg et al., "Introduction to Mathematical Statistics," 8th ed., Pearson, 2019.</li>
            <li>J. E. Freund and B. M. Perles, "Modern Elementary Statistics," 12th ed., Pearson, 2014.</li>
            <li>G. Casella and R. L. Berger, "Statistical Inference," 2nd ed., Duxbury, 2002.</li>
            <li>D. Wackerly et al., "Mathematical Statistics with Applications," 7th ed., Cengage, 2008.</li>
            <li>B. Efron and T. Hastie, "Computer Age Statistical Inference", Cambridge University Press, 2016.</li>
          </ol>
        </div>
      `
    },
    4: {
      title: "4. Probabilitas dan Distribusi",
      subtitle: "Konsep dasar probabilitas, distribusi diskrit dan kontinu",
      content: `
        <h2>4. Probabilitas dan Distribusi Lanjutan</h2>
        
        <h3>Konsep Fundamental Probabilitas</h3>
        <p>Probabilitas adalah ukuran numerik kemungkinan terjadinya suatu kejadian, dengan nilai antara 0 dan 1. Konsep ini merupakan fondasi untuk semua metode statistika inferensial.</p>
        
        <p><strong>Definisi Probabilitas:</strong></p>
        <ul>
          <li><strong>Pendekatan Klasik:</strong> P(A) = jumlah hasil yang menguntungkan / total hasil yang mungkin</li>
          <li><strong>Pendekatan Frekuensi Relatif:</b> P(A) = limit (frekuensi A / jumlah percobaan) saat n → ∞</li>
          <li><strong>Pendekatan Subjektif:</strong> Berdasarkan keyakinan atau pengalaman pribadi</li>
        </ul>
        
        <h3>Ruang Sampel dan Kejadian</h3>
        <ul>
          <li><strong>Ruang Sampel (S):</strong> Himpunan semua hasil yang mungkin dari suatu eksperimen</li>
          <li><strong>Kejadian (Event):</strong> Subset dari ruang sampel</li>
          <li><strong>Kejadian Sederhana:</strong> Kejadian yang hanya memuat satu hasil</li>
          <li><strong>Kejadian Majemuk:</strong> Kejadian yang memuat lebih dari satu hasil</li>
        </ul>
        
        <h3>Aturan-aturan Probabilitas</h3>
        <ul>
          <li><strong>Aturan Penjumlahan:</strong>
            <p>P(A∪B) = P(A) + P(B) - P(A∩B)</p>
            <p>Untuk kejadian saling asing: P(A∪B) = P(A) + P(B)</p>
          </li>
          <li><strong>Aturan Perkalian:</strong>
            <p>P(A∩B) = P(A|B) × P(B) = P(B|A) × P(A)</p>
            <p>Untuk kejadian independen: P(A∩B) = P(A) × P(B)</p>
          </li>
          <li><strong>Probabilitas Bersyarat:</strong>
            <p>P(A|B) = P(A∩B) / P(B), dimana P(B) > 0</p>
          </li>
          <li><strong>Teorema Bayes:</strong>
            <p>P(A|B) = [P(B|A) × P(A)] / P(B)</p>
          </li>
        </ul>
        
        <h3>Distribusi Sampling</h3>
        <p>Distribusi sampling adalah distribusi probabilitas dari statistik sampel yang diperoleh dari pengambilan sampel berulang dari populasi yang sama.</p>
        
        <ul>
          <li><strong>Central Limit Theorem (CLT):</strong>
            <p>Untuk sampel berukuran besar (n≥30), distribusi sampling rata-rata mendekati normal terlepas dari bentuk distribusi populasi</p>
          </li>
          <li><strong>Standard Error:</strong>
            <p>SE = σ/√n (jika σ diketahui) atau SE = s/√n (jika σ tidak diketahui)</p>
          </li>
          <li><strong>Distribusi Sampling Proporsi:</strong>
            <p>Untuk sampel besar, p̂ ~ N(π, √[π(1-π)/n])</p>
          </li>
        </ul>
        
        <h3>Teorema Limit Pusat dan Aplikasinya</h3>
        <p>CLT memungkinkan kita menggunakan distribusi normal untuk inferensi statistik meskipun populasi tidak berdistribusi normal, asalkan ukuran sampel cukup besar.</p>
        
        <div class="references">
          <h4>Referensi</h4>
          <ol>
            <li>S. Ross, "A First Course in Probability," 10th ed., Pearson, 2019.</li>
            <li>A. Papoulis and S. U. Pillai, "Probability, Random Variables and Stochastic Processes," 4th ed., McGraw-Hill, 2002.</li>
            <li>K. L. Chung, "A Course in Probability Theory," 3rd ed., Academic Press, 2001.</li>
            <li>P. G. Hoel et al., "Introduction to Probability Theory," Houghton Mifflin, 1971.</li>
          </ol>
        </div>
      `
    },
    5: {
      title: "5. Teori Statistika Lanjut",
      subtitle: "GLM, Non-Linear Model, Bayesian",
      content: `
        <h2>5. Teori Statistika Lanjut</h2>
        
        <h3>Generalized Linear Models (GLM)</h3>
        <p>GLM adalah ekstensi fleksibel dari regresi linear klasik yang memungkinkan variabel respon memiliki distribusi selain normal dan hubungan non-linear dengan variabel prediktor melalui fungsi link.</p>
        
        <p><strong>Komponen GLM:</strong></p>
        <ul>
          <li><strong>Random Component:</strong> Distribusi variabel respon (eksponensial family)</li>
          <li><strong>Systematic Component:</strong> Linear combination dari variabel prediktor</li>
          <li><strong>Link Function:</strong> Menghubungkan mean dengan linear predictor</li>
        </ul>
        
        <p><strong>Jenis-jenis GLM:</strong></p>
        <ul>
          <li><strong>Regresi Logistik:</strong> Untuk variabel respon biner (0/1), link function = logit</li>
          <li><strong>Regresi Poisson:</strong> Untuk data count, link function = log</li>
          <li><strong>Regresi Gamma:</strong> Untuk data positif kontinyu dengan varians yang meningkat dengan mean</li>
          <li><strong>Regresi Multinomial:</strong> Untuk variabel kategorikal dengan lebih dari 2 kategori</li>
        </ul>
        
        <h3>Model Non-Linear</h3>
        <p>Model yang menangkap hubungan non-linear antar variabel tanpa transformasi linear:</p>
        
        <ul>
          <li><strong>Polynomial Regression:</strong>
            <p>y = β₀ + β₁x + β₂x² + ... + βₖxᵏ + ε</p>
          </li>
          <li><strong>Exponential Models:</strong>
            <p>y = ae^(bx) + ε</p>
          </li>
          <li><strong>Power Models:</strong>
            <p>y = ax^b + ε</p>
          </li>
          <li><strong>Logistic Growth Models:</strong>
            <p>y = K/(1 + ae^(-bx))</p>
          </li>
          <li><strong>Spline Regression:</strong> Piecewise polynomials untuk fleksibilitas lokal</li>
        </ul>
        
        <h3>Statistika Bayesian</h3>
        <p>Pendekatan statistika yang menggunakan teorema Bayes untuk update keyakinan (belief) tentang parameter berdasarkan data yang diamati.</p>
        
        <p><strong>Komponen Utama:</strong></p>
        <ul>
          <li><strong>Prior Distribution π(θ):</strong> Keyakinan awal tentang parameter sebelum melihat data</li>
          <li><strong>Likelihood L(θ|data):</strong> Fungsi kemungkinan data given parameter</li>
          <li><strong>Posterior Distribution π(θ|data):</strong> Keyakinan yang diperbarui setelah melihat data</li>
          <li><strong>Predictive Distribution:</strong> Distribusi untuk prediksi data masa depan</li>
        </ul>
        
        <p><strong>Teorema Bayes:</strong></p>
        <p>π(θ|data) ∝ L(θ|data) × π(θ)</p>
        
        <p><strong>Keunggulan Pendekatan Bayesian:</strong></p>
        <ul>
          <li>Dapat mengincorporate prior knowledge</li>
          <li>Memberikan distribusi lengkap parameter, bukan hanya point estimate</li>
          <li>Natural way untuk sequential learning</li>
          <li>Dapat handle uncertainty secara komprehensif</li>
        </ul>
        
        <h3>Metode Komputasi Modern</h3>
        <ul>
          <li><strong>Markov Chain Monte Carlo (MCMC):</strong>
            <p>Gibbs Sampling, Metropolis-Hastings algorithm</p>
          </li>
          <li><strong>Variational Inference:</strong> Aproksimasi deterministik untuk posterior</li>
          <li><strong>Bootstrap Methods:</strong> Resampling untuk estimasi distribusi sampling</li>
          <li><strong>Cross-Validation:</strong> Untuk model selection dan validation</li>
        </ul>
        
        <div class="references">
          <h4>Referensi</h4>
          <ol>
            <li>P. McCullagh and J. A. Nelder, "Generalized Linear Models," 2nd ed., Chapman & Hall, 1989.</li>
            <li>A. Gelman et al., "Bayesian Data Analysis," 3rd ed., CRC Press, 2013.</li>
            <li>D. M. Bates and D. G. Watts, "Nonlinear Regression Analysis and Its Applications," Wiley, 1988.</li>
            <li>C. P. Robert, "The Bayesian Choice," 2nd ed., Springer, 2007.</li>
            <li>T. Hastie et al., "The Elements of Statistical Learning," 2nd ed., Springer, 2009.</li>
            <li>B. Efron and R. J. Tibshirani, "An Introduction to the Bootstrap," Chapman & Hall, 1993.</li>
          </ol>
        </div>
      `
    },
    6: {
      title: "6. Penerapan Statistika",
      subtitle: "Komputer, AI, sains data, big data",
      content: `
        <h2>6. Penerapan Statistika dalam Berbagai Bidang</h2>
        
        <h3>Statistika dalam Ilmu Komputer</h3>
        <p>Statistika memainkan peran fundamental dalam berbagai aspek ilmu komputer dan teknologi informasi:</p>
        
        <ul>
          <li><strong>Algoritma Randomized:</strong>
            <p>- Monte Carlo methods untuk simulasi dan optimisasi</p>
            <p>- Simulated annealing untuk optimisasi global</p>
            <p>- Randomized algorithms dalam sorting dan searching</p>
          </li>
          <li><strong>Kriptografi dan Keamanan:</strong>
            <p>- Analisis entropi untuk kekuatan kunci enkripsi</p>
            <p>- Statistical tests untuk random number generators</p>
            <p>- Frequency analysis dalam cryptanalysis</p>
          </li>
          <li><strong>Computer Graphics dan Rendering:</strong>
            <p>- Monte Carlo ray tracing</p>
            <p>- Importance sampling untuk rendering realistik</p>
            <p>- Noise functions untuk procedural textures</p>
          </li>
          <li><strong>Database dan Information Retrieval:</strong>
            <p>- Query optimization menggunakan statistik tabel</p>
            <p>- Text mining dan document classification</p>
            <p>- Recommendation systems</p>
          </li>
        </ul>
        
        <h3>Artificial Intelligence (AI) dan Machine Learning</h3>
        <p>Statistika adalah fondasi matematika untuk sebagian besar teknik AI modern:</p>
        
        <ul>
          <li><strong>Supervised Learning:</strong>
            <p>- Classification: Logistic regression, SVM, decision trees</p>
            <p>- Regression: Linear/non-linear regression, ensemble methods</p>
            <p>- Model evaluation: Cross-validation, ROC curves, confusion matrices</p>
          </li>
          <li><strong>Unsupervised Learning:</strong>
            <p>- Clustering: K-means, hierarchical clustering, DBSCAN</p>
            <p>- Dimensionality reduction: PCA, t-SNE, UMAP</p>
            <p>- Density estimation: Gaussian mixture models</p>
          </li>
          <li><strong>Deep Learning:</strong>
            <p>- Stochastic gradient descent dan variants</p>
            <p>- Regularization techniques (L1/L2, dropout)</p>
            <p>- Bayesian neural networks</p>
          </li>
          <li><strong>Natural Language Processing:</strong>
            <p>- N-gram models dan language modeling</p>
            <p>- Hidden Markov Models untuk sequence labeling</p>
            <p>- Topic modeling (LDA, LSA)</p>
          </li>
        </ul>
        
        <h3>Data Science dan Analytics</h3>
        <p>Integrasi statistika, programming, dan domain knowledge untuk ekstraksi insight dari data:</p>
        
        <ul>
          <li><strong>Exploratory Data Analysis (EDA):</strong>
            <p>- Descriptive statistics dan visualization</p>
            <p>- Pattern recognition dan anomaly detection</p>
            <p>- Data quality assessment</p>
          </li>
          <li><strong>Feature Engineering:</strong>
            <p>- Variable selection dan transformation</p>
            <p>- Handling missing data dan outliers</p>
            <p>- Creating derived variables</p>
          </li>
          <li><strong>Model Development:</strong>
            <p>- Model selection dan hyperparameter tuning</p>
            <p>- Cross-validation dan performance metrics</p>
            <p>- Ensemble methods dan model stacking</p>
          </li>
          <li><strong>Experimental Design:</strong>
            <p>- A/B testing dan multivariate testing</p>
            <p>- Causal inference methods</p>
            <p>- Statistical power analysis</p>
          </li>
        </ul>
        
        <h3>Big Data dan Computational Statistics</h3>
        <p>Tantangan dan solusi statistika dalam era big data:</p>
        
        <ul>
          <li><strong>Sampling Strategies:</strong>
            <p>- Reservoir sampling untuk streaming data</p>
            <p>- Stratified sampling untuk dataset besar</p>
            <p>- Adaptive sampling methods</p>
          </li>
          <li><strong>Distributed Computing:</strong>
            <p>- MapReduce framework untuk statistical computation</p>
            <p>- Parallel algorithms untuk matrix operations</p>
            <p>- Distributed machine learning (Apache Spark MLlib)</p>
          </li>
          <li><strong>Streaming Analytics:</strong>
            <p>- Online algorithms untuk real-time statistics</p>
            <p>- Sliding window techniques</p>
            <p>- Approximate algorithms (Count-Min Sketch, HyperLogLog)</p>
          </li>
          <li><strong>Scalable Statistical Methods:</strong>
            <p>- Stochastic gradient methods</p>
            <p>- Mini-batch processing</p>
            <p>- Approximation algorithms untuk large-scale inference</p>
          </li>
        </ul>
        
        <h3>Aplikasi Spesifik Bidang Lain</h3>
        <ul>
          <li><strong>Bioinformatics:</strong> Sequence analysis, gene expression, phylogenetics</li>
          <li><strong>Finance:</strong> Risk modeling, portfolio optimization, algorithmic trading</li>
          <li><strong>Healthcare:</strong> Clinical trials, epidemiology, medical imaging</li>
          <li><strong>Marketing:</strong> Customer segmentation, churn prediction, recommendation</li>
          <li><strong>Quality Control:</strong> Statistical process control, Six Sigma</li>
        </ul>
        
        <div class="references">
          <h4>Referensi</h4>
          <ol>
            <li>T. Hastie et al., "The Elements of Statistical Learning," 2nd ed., Springer, 2009.</li>
            <li>G. James et al., "An Introduction to Statistical Learning," 2nd ed., Springer, 2021.</li>
            <li>J. VanderPlas, "Python Data Science Handbook," O'Reilly, 2016.</li>
            <li>C. M. Bishop, "Pattern Recognition and Machine Learning," Springer, 2006.</li>
            <li>A. Gelman and J. Hill, "Data Analysis Using Regression and Multilevel/Hierarchical Models," Cambridge, 2007.</li>
            <li>J. Dean and S. Ghemawat, "MapReduce: Simplified Data Processing on Large Clusters," OSDI, 2004.</li>
          </ol>
        </div>
      `
    },
    7: {
      title: "7. Materi Lainnya",
      subtitle: "Topik tambahan dan pengembangan",
      content: `
        <h2>7. Materi Lainnya</h2>
        
        <h3>Statistika Multivariat</h3>
        <p>Analisis data dengan banyak variabel secara simultan untuk memahami struktur dan hubungan kompleks dalam data:</p>
        
        <ul>
          <li><strong>MANOVA (Multivariate ANOVA):</strong>
            <p>Ekstensi ANOVA untuk multiple dependent variables</p>
          </li>
          <li><strong>Principal Component Analysis (PCA):</strong>
            <p>Reduksi dimensi dengan mempertahankan varians maksimum</p>
          </li>
          <li><strong>Factor Analysis:</strong>
            <p>Mengidentifikasi faktor laten yang menjelaskan korelasi antar variabel</p>
          </li>
          <li><strong>Canonical Correlation Analysis:</strong>
            <p>Menganalisis hubungan antara dua set variabel</p>
          </li>
          <li><strong>Discriminant Analysis:</strong>
            <p>Klasifikasi berdasarkan kombinasi linear variabel prediktor</p>
          </li>
          <li><strong>Cluster Analysis:</strong>
            <p>Pengelompokan objek berdasarkan kemiripan karakteristik</p>
          </li>
          <li><strong>Multidimensional Scaling (MDS):</strong>
            <p>Visualisasi data high-dimensional dalam ruang lower-dimensional</p>
          </li>
        </ul>
        
        <h3>Time Series Analysis</h3>
        <p>Analisis data yang berurutan dalam waktu untuk memahami pola temporal dan membuat prediksi:</p>
        
        <ul>
          <li><strong>Komponen Time Series:</strong>
            <p>- Trend: Pola jangka panjang</p>
            <p>- Seasonality: Pola berulang dalam periode tertentu</p>
            <p>- Cyclical: Pola berulang tanpa periode tetap</p>
            <p>- Irregular: Komponen random</p>
          </li>
          <li><strong>ARIMA Models:</strong>
            <p>- AR (Autoregressive): Xt = φ₁Xt-1 + ... + φₚXt-p + εt</p>
            <p>- MA (Moving Average): Xt = εt + θ₁εt-1 + ... + θₚεt-q</p>
            <p>- Integration: Differencing untuk stationarity</p>
          </li>
          <li><strong>Forecasting Methods:</strong>
            <p>- Exponential smoothing</p>
            <p>- Holt-Winters method</p>
            <p>- State space models</p>
          </li>
          <li><strong>Advanced Models:</strong>
            <p>- GARCH untuk volatility modeling</p>
            <p>- Vector Autoregression (VAR)</p>
            <p>- Cointegration analysis</p>
          </li>
        </ul>
        
        <h3>Survival Analysis</h3>
        <p>Analisis waktu hingga kejadian tertentu terjadi (event time analysis):</p>
        
        <ul>
          <li><strong>Key Concepts:</strong>
            <p>- Survival function S(t) = P(T > t)</p>
            <p>- Hazard function h(t) = lim[P(t ≤ T < t+Δt|T ≥ t)/Δt]</p>
            <p>- Censoring: Right, left, interval censoring</p>
          </li>
          <li><strong>Non-parametric Methods:</strong>
            <p>- Kaplan-Meier estimator untuk survival curve</p>
            <p>- Log-rank test untuk comparing survival curves</p>
          </li>
          <li><strong>Semi-parametric Methods:</strong>
            <p>- Cox proportional hazards model</p>
            <p>- Partial likelihood estimation</p>
          </li>
          <li><strong>Parametric Methods:</strong>
            <p>- Exponential, Weibull, Log-normal models</p>
            <p>- Accelerated failure time models</p>
          </li>
        </ul>
        
        <h3>Statistika Non-parametrik Lanjutan</h3>
        <p>Metode robust yang tidak mengasumsikan distribusi parametrik tertentu:</p>
        
        <ul>
          <li><strong>Resampling Methods:</strong>
            <p>- Bootstrap untuk estimasi standard error dan confidence intervals</p>
            <p>- Jackknife untuk bias reduction</p>
            <p>- Permutation tests untuk exact p-values</p>
          </li>
          <li><strong>Rank-based Methods:</strong>
            <p>- Spearman correlation untuk monotonic relationships</p>
            <p>- Kendall's tau untuk concordance</p>
            <p>- Rank sum tests (Mann-Whitney, Kruskal-Wallis)</p>
          </li>
          <li><strong>Kernel Methods:</strong>
            <p>- Kernel density estimation</p>
            <p>- Non-parametric regression (local regression, splines)</p>
            <p>- Support vector machines</p>
          </li>
          <li><strong>Order Statistics:</strong>
            <p>- Quantile regression</p>
            <p>- Extreme value theory</p>
            <p>- Robust estimators (median, MAD)</p>
          </li>
        </ul>
        
        <h3>Computational Statistics</h3>
        <ul>
          <li><strong>Numerical Methods:</strong> Newton-Raphson, EM algorithm</li>
          <li><strong>Simulation Methods:</strong> Monte Carlo integration, importance sampling</li>
          <li><strong>Optimization:</strong> Maximum likelihood estimation, least squares</li>
          <li><strong>High-Performance Computing:</strong> Parallel processing untuk statistical computation</li>
        </ul>
        
        <div class="references">
          <h4>Referensi</h4>
          <ol>
            <li>R. A. Johnson and D. W. Wichern, "Applied Multivariate Statistical Analysis," 6th ed., Pearson, 2014.</li>
            <li>P. J. Brockwell and R. A. Davis, "Introduction to Time Series and Forecasting," 3rd ed., Springer, 2016.</li>
            <li>D. Collett, "Modelling Survival Data in Medical Research," 3rd ed., CRC Press, 2015.</li>
            <li>E. L. Lehmann and J. P. Romano, "Testing Statistical Hypotheses," 3rd ed., Springer, 2005.</li>
            <li>W. Härdle et al., "Nonparametric and Semiparametric Models," Springer, 2004.</li>
            <li>G. H. Givens and J. A. Hoeting, "Computational Statistics," 2nd ed., Wiley, 2013.</li>
          </ol>
        </div>
      `
    },
    8: {
      title: "8. AnalysisTools",
      subtitle: "Tools analisis data statistik interaktif",
      content: `
        <h2>8. AnalysisTools - Tools Analisis Statistik</h2>
        <p>Platform tools interaktif untuk melakukan berbagai jenis analisis statistik dengan mudah dan akurat.</p>
        
        <div class="analysis-tools">
          <h3>Tools Analisis Statistik Tersedia</h3>
          <div class="tools-grid">
            <button class="tool-btn" onclick="showAnalysisTool('deskriptif')">Statistik Deskriptif</button>
            <button class="tool-btn" onclick="showAnalysisTool('uji-mean')">Uji t (t-Test)</button>
            <button class="tool-btn" onclick="showAnalysisTool('anova')">ANOVA</button>
            <button class="tool-btn" onclick="showAnalysisTool('mann-whitney')">Mann-Whitney U</button>
            <button class="tool-btn" onclick="showAnalysisTool('chi-square')">Chi-Square Test</button>
            <button class="tool-btn" onclick="showAnalysisTool('korelasi')">Analisis Korelasi</button>
            <button class="tool-btn" onclick="showAnalysisTool('regresi')">Regresi Linear</button>
            <button class="tool-btn" onclick="showAnalysisTool('clustering')">Clustering</button>
            <button class="tool-btn" onclick="showAnalysisTool('factor-analysis')">Factor Analysis</button>
            <button class="tool-btn" onclick="showAnalysisTool('uji-asumsi')">Uji Asumsi Klasik</button>
            <button class="tool-btn" onclick="showAnalysisTool('uji-instrumen')">Uji Validitas & Reliabilitas</button>
            <button class="tool-btn" onclick="showAnalysisTool('power-analysis')">Power Analysis</button>
          </div>
        </div>
        
        <h3>Cara Penggunaan Tools</h3>
        <ol>
          <li>Pilih jenis analisis yang sesuai dengan tujuan penelitian Anda</li>
          <li>Upload file data (.csv, .xlsx) atau input data secara manual</li>
          <li>Atur parameter analisis sesuai kebutuhan</li>
          <li>Klik tombol "Analisis" untuk memproses data</li>
          <li>Interpretasikan hasil output yang disediakan</li>
          <li>Download laporan hasil analisis dalam format PDF atau Excel</li>
        </ol>
        
        <h3>Format Data yang Didukung</h3>
        <ul>
          <li><strong>File CSV:</strong> Comma-separated values</li>
          <li><strong>File Excel:</strong> Format .xlsx dan .xls</li>
          <li><strong>Input Manual:</strong> Copy-paste dari spreadsheet</li>
          <li><strong>Database Connection:</strong> Koneksi langsung ke database (fitur premium)</li>
        </ul>
        
        <h3>Fitur Tambahan</h3>
        <ul>
          <li>Visualisasi otomatis hasil analisis</li>
          <li>Export hasil dalam berbagai format</li>
          <li>History analisis untuk tracking progress</li>
          <li>Template report untuk dokumentasi</li>
          <li>Kolaborasi tim untuk proyek bersama</li>
        </ul>
      `
    }
  };

  // Konten untuk analysis tools (sekarang disimpan dalam objek global)
  let analysisToolContents = {
    'deskriptif': `
      <h2>Tool Analisis Statistik Deskriptif</h2>
      <p>Analisis komprehensif karakteristik data Anda dengan berbagai ukuran pemusatan, penyebaran, dan visualisasi.</p>
      
      <div class="analysis-form">
        <h3>Input Data</h3>
        <div class="form-group">
          <label>Metode Input Data:</label>
          <select id="inputMethod_deskriptif" onchange="toggleInputMethod('deskriptif')">
            <option value="manual">Input Manual</option>
            <option value="sample">Gunakan Sample Data</option>
            <option value="file">Upload File (.csv, .xlsx)</option>
          </select>
        </div>
        
        <div class="form-group file-input-group_deskriptif" style="display:none;">
          <label>Upload File Data:</label>
          <input type="file" accept=".csv,.xlsx" id="dataFile_deskriptif" onchange="handleFileUpload('deskriptif')"/>
        </div>
        
        <div class="form-group manual-input-group_deskriptif">
          <label>Atau Input Data Manual (pisahkan dengan koma atau baris baru):</label>
          <textarea id="manualData_deskriptif" rows="6" placeholder="Contoh: 23, 45, 67, 34, 56, 78, 45, 67, 89, 23"></textarea>
        </div>

        <div class="form-group sample-input-group_deskriptif" style="display:none;">
          <label>Pilih Sample Data:</label>
          <select id="sampleData_deskriptif" onchange="loadSampleData('deskriptif')">
            <option value="">-- Pilih Sample --</option>
            <option value="sample1">Sample Data 1 (Penjualan)</option>
            <option value="sample2">Sample Data 2 (Tinggi Badan)</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>Pilih Variabel untuk Analisis:</label>
          <select id="variables_deskriptif" multiple size="5">
            <option value="Data">Data</option>
          </select>
        </div>
        
        <button class="btn-primary" onclick="runDescriptive()">Analisis Deskriptif</button>
        
        <div id="descriptiveResults" style="margin-top: 20px;"></div>
      </div>
    `,
    
    'uji-mean': `
      <h2>Tool Uji t (t-Test)</h2>
      <p>Uji hipotesis untuk rata-rata populasi dengan berbagai variasi uji t.</p>
      
      <div class="analysis-form">
        <h3>Input Data</h3>
        <div class="form-group">
          <label>Metode Input Data:</label>
          <select id="inputMethod_uji-mean" onchange="toggleInputMethod('uji-mean')">
            <option value="manual">Input Manual</option>
            <option value="sample">Gunakan Sample Data</option>
            <option value="file">Upload File (.csv, .xlsx)</option>
          </select>
        </div>
        
        <div class="form-group file-input-group_uji-mean" style="display:none;">
          <label>Upload File Data:</label>
          <input type="file" accept=".csv,.xlsx" id="dataFile_uji-mean" onchange="handleFileUpload('uji-mean')"/>
        </div>
        
        <div class="form-group sample-input-group_uji-mean" style="display:none;">
          <label>Pilih Sample Data:</label>
          <select id="sampleData_uji-mean" onchange="loadSampleData('uji-mean')">
            <option value="">-- Pilih Sample --</option>
            <option value="sample_one_sample">One-sample t-test (Data A)</option>
            <option value="sample_two_sample">Two-sample t-test (Data A & B)</option>
            <option value="sample_paired">Paired t-test (Pre & Post)</option>
          </select>
        </div>

        <h3>Pengaturan Uji t</h3>
        <div class="form-group">
          <label>Jenis Uji t:</label>
          <select id="tTestType" onchange="updateTTestForm()">
            <option value="one-sample">One-sample t-test</option>
            <option value="two-sample">Independent two-sample t-test</option>
            <option value="paired">Paired t-test</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>Tingkat Signifikansi (α):</label>
          <select id="alpha">
            <option value="0.01">0.01 (99% confidence)</option>
            <option value="0.05" selected>0.05 (95% confidence)</option>
            <option value="0.10">0.10 (90% confidence)</option>
          </select>
        </div>
        
        <div class="form-group manual-input-group_uji-mean">
          <label>Data Sampel 1 (pisahkan dengan koma atau baris baru):</label>
          <textarea id="sample1_tTest" rows="4" placeholder="Contoh: 23, 45, 67, 34, 56"></textarea>
        </div>
        
        <div class="form-group" id="sample2Group_tTest" style="display:none;">
          <label>Data Sampel 2 (pisahkan dengan koma atau baris baru):</label>
          <textarea id="sample2_tTest" rows="4" placeholder="Contoh: 30, 50, 70, 40, 60"></textarea>
        </div>
        
        <div class="form-group" id="muGroup_tTest">
          <label>Nilai μ₀ (untuk one-sample test):</label>
          <input type="number" id="mu0_tTest" value="0" step="0.01"/>
        </div>
        
        <button class="btn-primary" onclick="runTTest()">Hitung Uji t</button>
        
        <div id="tTestResults" style="margin-top: 20px;"></div>
      </div>
    `,
    
    'anova': `
      <h2>Tool Analisis Varians (ANOVA)</h2>
      <p>Uji perbedaan rata-rata antar kelompok untuk tiga atau lebih kelompok.</p>
      
      <div class="analysis-form">
        <h3>Input Data</h3>
        <div class="form-group">
          <label>Metode Input Data:</label>
          <select id="inputMethod_anova" onchange="toggleInputMethod('anova')">
            <option value="manual">Input Manual</option>
            <option value="sample">Gunakan Sample Data</option>
            <option value="file">Upload File (.csv, .xlsx)</option>
          </select>
        </div>
        
        <div class="form-group file-input-group_anova" style="display:none;">
          <label>Upload File Data:</label>
          <input type="file" accept=".csv,.xlsx" id="dataFile_anova" onchange="handleFileUpload('anova')"/>
        </div>
        
        <div class="form-group sample-input-group_anova" style="display:none;">
          <label>Pilih Sample Data:</label>
          <select id="sampleData_anova" onchange="loadSampleData('anova')">
            <option value="">-- Pilih Sample --</option>
            <option value="sample_one_way">One-way ANOVA (3 Kelompok)</option>
          </select>
        </div>

        <h3>Pengaturan ANOVA</h3>
        <div class="form-group">
          <label>Jenis ANOVA:</label>
          <select id="anovaType">
            <option value="one-way">One-way ANOVA</option>
            <!-- <option value="two-way">Two-way ANOVA</option> -->
            <!-- <option value="repeated">Repeated Measures ANOVA</option> -->
          </select>
        </div>
        
        <div class="form-group manual-input-group_anova">
          <label>Input Data Kelompok (pisahkan nilai dengan koma, kelompok dengan baris baru):</label>
          <textarea id="anovaData" rows="8" placeholder="Format data:
Kelompok1: 23, 45, 67, 34, 56
Kelompok2: 34, 56, 78, 45, 67
Kelompok3: 45, 67, 89, 56, 78"></textarea>
        </div>
        
        <div class="form-group">
          <label>Tingkat Signifikansi (α):</label>
          <select id="alpha_anova">
            <option value="0.01">0.01 (99% confidence)</option>
            <option value="0.05" selected>0.05 (95% confidence)</option>
            <option value="0.10">0.10 (90% confidence)</option>
          </select>
        </div>

        <div class="form-group">
          <label>Post-hoc Test (jika ANOVA signifikan):</label>
          <select id="posthoc_anova">
            <option value="none">Tidak ada</option>
            <option value="tukey">Tukey HSD</option>
            <!-- <option value="bonferroni">Bonferroni</option> -->
            <!-- <option value="scheffe">Scheffé</option> -->
          </select>
        </div>
        
        <button class="btn-primary" onclick="runANOVA()">Analisis ANOVA</button>
        
        <div id="anovaResults" style="margin-top: 20px;"></div>
      </div>
    `,
    
    'korelasi': `
      <h2>Tool Analisis Korelasi</h2>
      <p>Menganalisis kekuatan dan arah hubungan antara dua atau lebih variabel.</p>
      
      <div class="analysis-form">
        <h3>Input Data</h3>
        <div class="form-group">
          <label>Metode Input Data:</label>
          <select id="inputMethod_korelasi" onchange="toggleInputMethod('korelasi')">
            <option value="manual">Input Manual</option>
            <option value="sample">Gunakan Sample Data</option>
            <option value="file">Upload File (.csv, .xlsx)</option>
          </select>
        </div>
        
        <div class="form-group file-input-group_korelasi" style="display:none;">
          <label>Upload File Data:</label>
          <input type="file" accept=".csv,.xlsx" id="dataFile_korelasi" onchange="handleFileUpload('korelasi')"/>
        </div>
        
        <div class="form-group sample-input-group_korelasi" style="display:none;">
          <label>Pilih Sample Data:</label>
          <select id="sampleData_korelasi" onchange="loadSampleData('korelasi')">
            <option value="">-- Pilih Sample --</option>
            <option value="sample_pearson">Pearson Correlation (X & Y)</option>
          </select>
        </div>

        <h3>Pengaturan Analisis Korelasi</h3>
        <div class="form-group">
          <label>Jenis Korelasi:</label>
          <select id="correlationType">
            <option value="pearson">Pearson (Linear correlation)</option>
            <option value="spearman">Spearman (Rank correlation)</option>
            <!-- <option value="kendall">Kendall's Tau</option> -->
          </select>
        </div>
        
        <div class="form-group manual-input-group_korelasi">
          <label>Data Variabel X (pisahkan dengan koma atau baris baru):</label>
          <textarea id="varX_korelasi" rows="3" placeholder="Contoh: 10, 12, 15, 18, 20"></textarea>
        </div>
        
        <div class="form-group manual-input-group_korelasi">
          <label>Data Variabel Y (pisahkan dengan koma atau baris baru):</label>
          <textarea id="varY_korelasi" rows="3" placeholder="Contoh: 25, 28, 30, 35, 38"></textarea>
        </div>
        
        <div class="form-group">
          <label>Tingkat Signifikansi (α):</label>
          <select id="corrAlpha">
            <option value="0.01">0.01</option>
            <option value="0.05" selected>0.05</option>
            <option value="0.10">0.10</option>
          </select>
        </div>
        
        <button class="btn-primary" onclick="runCorrelation()">Hitung Korelasi</button>
        
        <div id="correlationResults" style="margin-top: 20px;"></div>
      </div>
    `,
    
    'regresi': `
      <h2>Tool Analisis Regresi Linear</h2>
      <p>Memodelkan hubungan antara variabel dependen dan satu atau lebih variabel independen.</p>
      
      <div class="analysis-form">
        <h3>Input Data</h3>
        <div class="form-group">
          <label>Metode Input Data:</label>
          <select id="inputMethod_regresi" onchange="toggleInputMethod('regresi')">
            <option value="manual">Input Manual</option>
            <option value="sample">Gunakan Sample Data</option>
            <option value="file">Upload File (.csv, .xlsx)</option>
          </select>
        </div>
        
        <div class="form-group file-input-group_regresi" style="display:none;">
          <label>Upload File Data:</label>
          <input type="file" accept=".csv,.xlsx" id="dataFile_regresi" onchange="handleFileUpload('regresi')"/>
        </div>
        
        <div class="form-group sample-input-group_regresi" style="display:none;">
          <label>Pilih Sample Data:</label>
          <select id="sampleData_regresi" onchange="loadSampleData('regresi')">
            <option value="">-- Pilih Sample --</option>
            <option value="sample_simple_linear">Simple Linear Regression (X & Y)</option>
          </select>
        </div>

        <h3>Pengaturan Regresi</h3>
        <div class="form-group">
          <label>Jenis Regresi:</label>
          <select id="regressionType">
            <option value="simple">Simple Linear Regression</option>
            <!-- <option value="multiple">Multiple Linear Regression</option> -->
            <!-- <option value="polynomial">Polynomial Regression</option> -->
          </select>
        </div>
        
        <div class="form-group manual-input-group_regresi">
          <label>Variabel Dependen (Y) (pisahkan dengan koma atau baris baru):</label>
          <textarea id="dependentVar_regresi" rows="3" placeholder="Contoh: 25, 28, 30, 35, 38"></textarea>
        </div>
        
        <div class="form-group manual-input-group_regresi">
          <label>Variabel Independen (X) (pisahkan dengan koma atau baris baru):</label>
          <textarea id="independentVar_regresi" rows="3" placeholder="Contoh: 10, 12, 15, 18, 20"></textarea>
        </div>
        
        <div class="form-group">
          <label>Confidence Level:</label>
          <select id="confLevel">
            <option value="90">90%</option>
            <option value="95" selected>95%</option>
            <option value="99">99%</option>
          </select>
        </div>
        
        <div class="form-group">
          <input type="checkbox" id="includeResiduals"/>
          <label for="includeResiduals">Tampilkan analisis residual</label>
        </div>
        
        <button class="btn-primary" onclick="runRegression()">Analisis Regresi</button>
        
        <div id="regressionResults" style="margin-top: 20px;"></div>
      </div>
    `,
    'mann-whitney': `
      <h2>Tool Uji Mann-Whitney U</h2>
      <p>Uji non-parametrik untuk membandingkan dua kelompok independen.</p>
      <div class="analysis-form">
        <h3>Input Data</h3>
        <div class="form-group">
          <label>Metode Input Data:</label>
          <select id="inputMethod_mann-whitney" onchange="toggleInputMethod('mann-whitney')">
            <option value="manual">Input Manual</option>
            <option value="sample">Gunakan Sample Data</option>
            <option value="file">Upload File (.csv, .xlsx)</option>
          </select>
        </div>
        
        <div class="form-group file-input-group_mann-whitney" style="display:none;">
          <label>Upload File Data:</label>
          <input type="file" accept=".csv,.xlsx" id="dataFile_mann-whitney" onchange="handleFileUpload('mann-whitney')"/>
        </div>
        
        <div class="form-group sample-input-group_mann-whitney" style="display:none;">
          <label>Pilih Sample Data:</label>
          <select id="sampleData_mann-whitney" onchange="loadSampleData('mann-whitney')">
            <option value="">-- Pilih Sample --</option>
            <option value="sample_two_groups">Dua Kelompok Independen</option>
          </select>
        </div>

        <h3>Pengaturan Uji Mann-Whitney U</h3>
        <div class="form-group manual-input-group_mann-whitney">
          <label>Data Kelompok 1 (pisahkan dengan koma atau baris baru):</label>
          <textarea id="group1_mannwhitney" rows="4" placeholder="Contoh: 10, 12, 15, 11, 13"></textarea>
        </div>
        <div class="form-group manual-input-group_mann-whitney">
          <label>Data Kelompok 2 (pisahkan dengan koma atau baris baru):</label>
          <textarea id="group2_mannwhitney" rows="4" placeholder="Contoh: 14, 16, 13, 17, 15"></textarea>
        </div>
        <div class="form-group">
          <label>Tingkat Signifikansi (α):</label>
          <select id="alpha_mannwhitney">
            <option value="0.01">0.01</option>
            <option value="0.05" selected>0.05</option>
            <option value="0.10">0.10</option>
          </select>
        </div>
        <button class="btn-primary" onclick="runMannWhitney()">Hitung Mann-Whitney U</button>
        <div id="mannWhitneyResults" style="margin-top: 20px;"></div>
      </div>
    `,
    'chi-square': `
      <h2>Tool Uji Chi-Square</h2>
      <p>Uji untuk menganalisis hubungan antara variabel kategorikal (uji independensi) atau kesesuaian distribusi (goodness of fit).</p>
      <div class="analysis-form">
        <h3>Input Data</h3>
        <div class="form-group">
          <label>Metode Input Data:</label>
          <select id="inputMethod_chi-square" onchange="toggleInputMethod('chi-square')">
            <option value="manual">Input Manual</option>
            <option value="sample">Gunakan Sample Data</option>
            <option value="file">Upload File (.csv, .xlsx)</option>
          </select>
        </div>
        
        <div class="form-group file-input-group_chi-square" style="display:none;">
          <label>Upload File Data:</label>
          <input type="file" accept=".csv,.xlsx" id="dataFile_chi-square" onchange="handleFileUpload('chi-square')"/>
        </div>
        
        <div class="form-group sample-input-group_chi-square" style="display:none;">
          <label>Pilih Sample Data:</label>
          <select id="sampleData_chi-square" onchange="loadSampleData('chi-square')">
            <option value="">-- Pilih Sample --</option>
            <option value="sample_independence">Uji Independensi (Tabel 2x2)</option>
            <option value="sample_goodness_of_fit">Uji Goodness of Fit (3 Kategori)</option>
          </select>
        </div>

        <h3>Pengaturan Uji Chi-Square</h3>
        <div class="form-group">
          <label>Jenis Uji Chi-Square:</label>
          <select id="chiSquareType" onchange="updateChiSquareForm()">
            <option value="independence">Uji Independensi (Tabel Kontingensi)</option>
            <option value="goodness-of-fit">Uji Goodness of Fit</option>
          </select>
        </div>
        <div class="form-group manual-input-group_chi-square" id="contingencyTableGroup">
          <label>Input Tabel Kontingensi (pisahkan nilai dengan koma, baris dengan baris baru):</label>
          <textarea id="contingencyTable" rows="6" placeholder="Contoh (2x2):
10, 20
15, 5"></textarea>
          <small>Pastikan jumlah kolom konsisten untuk setiap baris.</small>
        </div>
        <div class="form-group manual-input-group_chi-square" id="goodnessOfFitGroup" style="display:none;">
          <label>Input Frekuensi Observasi (pisahkan dengan koma):</label>
          <textarea id="observedFrequencies" rows="3" placeholder="Contoh: 20, 30, 50"></textarea>
          <label>Input Frekuensi Harapan (pisahkan dengan koma, opsional, jika tidak diisi akan dianggap sama rata):</label>
          <textarea id="expectedFrequencies" rows="3" placeholder="Contoh: 25, 25, 50"></textarea>
        </div>
        <div class="form-group">
          <label>Tingkat Signifikansi (α):</label>
          <select id="alpha_chiSquare">
            <option value="0.01">0.01</option>
            <option value="0.05" selected>0.05</option>
            <option value="0.10">0.10</option>
          </select>
        </div>
        <button class="btn-primary" onclick="runChiSquare()">Hitung Chi-Square</button>
        <div id="chiSquareResults" style="margin-top: 20px;"></div>
      </div>
    `,
    'clustering': `
      <h2>Tool Clustering (K-Means)</h2>
      <p>Mengelompokkan data ke dalam K kelompok berdasarkan kemiripan.</p>
      <div class="analysis-form">
        <h3>Input Data</h3>
        <div class="form-group">
          <label>Metode Input Data:</label>
          <select id="inputMethod_clustering" onchange="toggleInputMethod('clustering')">
            <option value="manual">Input Manual</option>
            <option value="sample">Gunakan Sample Data</option>
            <option value="file">Upload File (.csv, .xlsx)</option>
          </select>
        </div>
        
        <div class="form-group file-input-group_clustering" style="display:none;">
          <label>Upload File Data:</label>
          <input type="file" accept=".csv,.xlsx" id="dataFile_clustering" onchange="handleFileUpload('clustering')"/>
        </div>
        
        <div class="form-group sample-input-group_clustering" style="display:none;">
          <label>Pilih Sample Data:</label>
          <select id="sampleData_clustering" onchange="loadSampleData('clustering')">
            <option value="">-- Pilih Sample --</option>
            <option value="sample_2d">Data 2 Dimensi</option>
          </select>
        </div>

        <h3>Pengaturan K-Means Clustering</h3>
        <div class="form-group manual-input-group_clustering">
          <label>Input Data (pisahkan nilai dengan koma, observasi dengan baris baru):</label>
          <textarea id="clusteringData" rows="8" placeholder="Contoh (data 2 dimensi):
1.0, 1.1
1.0, 1.2
3.0, 3.1
3.1, 3.0"></textarea>
          <small>Setiap baris adalah satu observasi, setiap kolom adalah satu fitur.</small>
        </div>
        <div class="form-group">
          <label>Jumlah Kluster (K):</label>
          <input type="number" id="numClusters" value="3" min="2"/>
        </div>
        <button class="btn-primary" onclick="runClustering()">Jalankan Clustering</button>
        <div id="clusteringResults" style="margin-top: 20px;"></div>
      </div>
    `,
    'factor-analysis': `
      <h2>Tool Factor Analysis (Analisis Faktor)</h2>
      <p>Mengidentifikasi faktor laten yang menjelaskan korelasi antar variabel yang diamati.</p>
      <div class="analysis-form">
        <h3>Input Data</h3>
        <div class="form-group">
          <label>Metode Input Data:</label>
          <select id="inputMethod_factor-analysis" onchange="toggleInputMethod('factor-analysis')">
            <option value="manual">Input Manual</option>
            <option value="sample">Gunakan Sample Data</option>
            <option value="file">Upload File (.csv, .xlsx)</option>
          </select>
        </div>
        
        <div class="form-group file-input-group_factor-analysis" style="display:none;">
          <label>Upload File Data:</label>
          <input type="file" accept=".csv,.xlsx" id="dataFile_factor-analysis" onchange="handleFileUpload('factor-analysis')"/>
        </div>
        
        <div class="form-group sample-input-group_factor-analysis" style="display:none;">
          <label>Pilih Sample Data:</label>
          <select id="sampleData_factor-analysis" onchange="loadSampleData('factor-analysis')">
            <option value="">-- Pilih Sample --</option>
            <option value="sample_3vars">Data 3 Variabel</option>
          </select>
        </div>

        <h3>Pengaturan Analisis Faktor</h3>
        <div class="form-group manual-input-group_factor-analysis">
          <label>Input Data (pisahkan nilai dengan koma, observasi dengan baris baru):</label>
          <textarea id="factorAnalysisData" rows="8" placeholder="Contoh (data 3 variabel):
10, 12, 11
15, 14, 16
20, 22, 21"></textarea>
          <small>Setiap baris adalah satu observasi, setiap kolom adalah satu variabel.</small>
        </div>
        <div class="form-group">
          <label>Jumlah Faktor yang Diekstrak:</label>
          <input type="number" id="numFactors" value="1" min="1"/>
        </div>
        <button class="btn-primary" onclick="runFactorAnalysis()">Jalankan Analisis Faktor</button>
        <div id="factorAnalysisResults" style="margin-top: 20px;"></div>
      </div>
    `,
    'uji-asumsi': `
      <h2>Tool Uji Asumsi Klasik</h2>
      <p>Melakukan pengujian asumsi normalitas, homogenitas varians, dan linearitas.</p>
      <div class="analysis-form">
        <h3>Input Data</h3>
        <div class="form-group">
          <label>Metode Input Data:</label>
          <select id="inputMethod_uji-asumsi" onchange="toggleInputMethod('uji-asumsi')">
            <option value="manual">Input Manual</option>
            <option value="sample">Gunakan Sample Data</option>
            <option value="file">Upload File (.csv, .xlsx)</option>
          </select>
        </div>
        
        <div class="form-group file-input-group_uji-asumsi" style="display:none;">
          <label>Upload File Data:</label>
          <input type="file" accept=".csv,.xlsx" id="dataFile_uji-asumsi" onchange="handleFileUpload('uji-asumsi')"/>
        </div>
        
        <div class="form-group sample-input-group_uji-asumsi" style="display:none;">
          <label>Pilih Sample Data:</label>
          <select id="sampleData_uji-asumsi" onchange="loadSampleData('uji-asumsi')">
            <option value="">-- Pilih Sample --</option>
            <option value="sample_normalitas">Uji Normalitas</option>
            <option value="sample_homogenitas">Uji Homogenitas</option>
          </select>
        </div>

        <h3>Pengaturan Uji Asumsi</h3>
        <div class="form-group">
          <label>Pilih Uji Asumsi:</label>
          <select id="assumptionTestType" onchange="updateAssumptionTestForm()">
            <option value="normalitas">Uji Normalitas (Shapiro-Wilk)</option>
            <option value="homogenitas">Uji Homogenitas Varians (Levene's Test)</option>
            <!-- <option value="linearitas">Uji Linearitas</option> -->
          </select>
        </div>
        <div class="form-group manual-input-group_uji-asumsi" id="normalitasDataGroup">
          <label>Input Data untuk Normalitas (pisahkan dengan koma atau baris baru):</label>
          <textarea id="normalitasData" rows="4" placeholder="Contoh: 23, 45, 67, 34, 56, 78, 45, 67, 89, 23"></textarea>
        </div>
        <div class="form-group manual-input-group_uji-asumsi" id="homogenitasDataGroup" style="display:none;">
          <label>Input Data Kelompok untuk Homogenitas (pisahkan nilai dengan koma, kelompok dengan baris baru):</label>
          <textarea id="homogenitasData" rows="6" placeholder="Contoh:
Kelompok1: 23, 45, 67
Kelompok2: 34, 56, 78"></textarea>
        </div>
        <div class="form-group">
          <label>Tingkat Signifikansi (α):</label>
          <select id="alpha_assumption">
            <option value="0.01">0.01</option>
            <option value="0.05" selected>0.05</option>
            <option value="0.10">0.10</option>
          </select>
        </div>
        <button class="btn-primary" onclick="runAssumptionTest()">Jalankan Uji Asumsi</button>
        <div id="assumptionTestResults" style="margin-top: 20px;"></div>
      </div>
    `,
    'uji-instrumen': `
      <h2>Tool Uji Validitas & Reliabilitas</h2>
      <p>Menguji kualitas instrumen penelitian (kuesioner).</p>
      <div class="analysis-form">
        <h3>Input Data</h3>
        <div class="form-group">
          <label>Metode Input Data:</label>
          <select id="inputMethod_uji-instrumen" onchange="toggleInputMethod('uji-instrumen')">
            <option value="manual">Input Manual</option>
            <option value="sample">Gunakan Sample Data</option>
            <option value="file">Upload File (.csv, .xlsx)</option>
          </select>
        </div>
        
        <div class="form-group file-input-group_uji-instrumen" style="display:none;">
          <label>Upload File Data:</label>
          <input type="file" accept=".csv,.xlsx" id="dataFile_uji-instrumen" onchange="handleFileUpload('uji-instrumen')"/>
        </div>
        
        <div class="form-group sample-input-group_uji-instrumen" style="display:none;">
          <label>Pilih Sample Data:</label>
          <select id="sampleData_uji-instrumen" onchange="loadSampleData('uji-instrumen')">
            <option value="">-- Pilih Sample --</option>
            <option value="sample_instrument">Data Kuesioner (3 Item)</option>
          </select>
        </div>

        <h3>Pengaturan Uji Instrumen</h3>
        <div class="form-group manual-input-group_uji-instrumen">
          <label>Input Data Respon Kuesioner (pisahkan nilai dengan koma, responden dengan baris baru):</label>
          <textarea id="instrumentData" rows="8" placeholder="Contoh (3 item, 5 responden):
1, 2, 3
2, 3, 4
3, 4, 5
4, 5, 4
5, 4, 3"></textarea>
          <small>Setiap baris adalah satu responden, setiap kolom adalah satu item pertanyaan.</small>
        </div>
        <div class="form-group">
          <label>Tingkat Signifikansi (α) untuk Validitas:</label>
          <select id="alpha_validity">
            <option value="0.01">0.01</option>
            <option value="0.05" selected>0.05</option>
            <option value="0.10">0.10</option>
          </select>
        </div>
        <button class="btn-primary" onclick="runInstrumentTest()">Jalankan Uji Instrumen</button>
        <div id="instrumentTestResults" style="margin-top: 20px;"></div>
      </div>
    `,
    'power-analysis': `
      <h2>Tool Power Analysis</h2>
      <p>Menentukan ukuran sampel yang diperlukan atau kekuatan uji statistik.</p>
      <div class="analysis-form">
        <h3>Pengaturan Power Analysis</h3>
        <div class="form-group">
          <label>Jenis Uji:</label>
          <select id="powerTestType" onchange="updatePowerAnalysisForm()">
            <option value="t-test">Uji t (Two-sample)</option>
            <option value="anova">ANOVA (One-way)</option>
            <option value="correlation">Korelasi Pearson</option>
            <option value="regression">Regresi Linear Sederhana</option>
          </select>
        </div>
        <div class="form-group">
          <label id="effectSizeLabel">Ukuran Efek (Cohen's d):</label>
          <input type="number" id="effectSize" value="0.5" step="0.1"/>
          <small id="effectSizeHint">0.2 (kecil), 0.5 (sedang), 0.8 (besar)</small>
        </div>
        <div class="form-group">
          <label>Tingkat Signifikansi (α):</label>
          <select id="alpha_power">
            <option value="0.01">0.01</option>
            <option value="0.05" selected>0.05</option>
            <option value="0.10">0.10</option>
          </select>
        </div>
        <div class="form-group">
          <label>Power yang Diinginkan (1-β):</label>
          <input type="number" id="desiredPower" value="0.8" step="0.05" min="0.5" max="0.99"/>
        </div>
        <button class="btn-primary" onclick="runPowerAnalysis()">Hitung Power/Ukuran Sampel</button>
        <div id="powerAnalysisResults" style="margin-top: 20px;"></div>
      </div>
    `
  };

  // Initial content for the welcome page
  let initialWelcomeContent = ''; // Will be set after DOMContentLoaded

  /**
   * Displays the content of a selected material.
   * @param {number} materialId - The ID of the material to display.
   */
  function showMaterial(materialId) {
    // Remove active class from all material items
    document.querySelectorAll('.material-item').forEach(item => {
      item.classList.remove('active');
    });
    
    // Add active class to the clicked item
    const clickedItem = document.querySelector(`.material-item[data-material-id="${materialId}"]`);
    if (clickedItem) {
      clickedItem.classList.add('active');
    }
    
    // Display material content
    const material = materialContents[materialId];
    if (material) {
      document.getElementById('pageContent').innerHTML = material.content;
    } else {
      document.getElementById('pageContent').innerHTML = '<p>Materi sedang dalam pengembangan atau tidak ditemukan.</p>';
    }

    // Re-enable editable content if in admin mode
    if (isAdminMode) {
      enableAdminEditing();
    }
  }

  /**
   * Displays the content of a selected analysis tool.
   * @param {string} toolId - The ID of the analysis tool to display.
   */
  function showAnalysisTool(toolId) {
    // Remove active class from all material items
    document.querySelectorAll('.material-item').forEach(item => {
      item.classList.remove('active');
    });
    // Set active class for AnalysisTools sidebar item
    const analysisToolsItem = document.querySelector('.material-item[data-material-id="8"]');
    if (analysisToolsItem) {
      analysisToolsItem.classList.add('active');
    }

    const content = analysisToolContents[toolId];
    if (content) {
      document.getElementById('pageContent').innerHTML = content;
      // Initialize specific tool forms if needed
      toggleInputMethod(toolId); // Initialize input method display for all tools
      if (toolId === 'uji-mean') {
        updateTTestForm();
      } else if (toolId === 'chi-square') {
        updateChiSquareForm();
      } else if (toolId === 'uji-asumsi') {
        updateAssumptionTestForm();
      } else if (toolId === 'power-analysis') {
        updatePowerAnalysisForm(); // Initialize power analysis form
      }
    } else {
      document.getElementById('pageContent').innerHTML = `
        <h2>${toolId}</h2>
        <p>Tool analisis untuk ${toolId} sedang dalam pengembangan.</p>
        <div class="analysis-form">
          <h3>Coming Soon</h3>
          <p>Fitur ini akan segera tersedia. Silakan hubungi admin untuk informasi lebih lanjut.</p>
        </div>
      `;
    }
  }

  /**
   * Toggles the visibility of the Help & FAQ modal.
   */
  function toggleHelpFAQModal() {
    const modal = document.getElementById('help-faq-modal');
    modal.classList.toggle('open');
    // Scroll chatbot messages to bottom when opened
    if (modal.classList.contains('open')) {
      const messagesContainer = document.getElementById('chatbot-messages');
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }
  }

  /**
   * Sends a message to the chatbot and displays the response.
   */
  function sendChatMessage() {
    const inputField = document.getElementById('chatbot-input-field');
    const message = inputField.value.trim();
    if (message === '') return;

    const messagesContainer = document.getElementById('chatbot-messages');
    
    // Add user message
    const userMessageDiv = document.createElement('div');
    userMessageDiv.classList.add('chatbot-message', 'user');
    userMessageDiv.textContent = message;
    messagesContainer.appendChild(userMessageDiv);

    inputField.value = ''; // Clear input
    messagesContainer.scrollTop = messagesContainer.scrollHeight; // Scroll to bottom

    // Get bot response
    setTimeout(() => {
      const botResponse = getBotResponse(message);
      const botMessageDiv = document.createElement('div');
      botMessageDiv.classList.add('chatbot-message', 'bot');
      botMessageDiv.innerHTML = botResponse; // Use innerHTML for potential links/formatting
      messagesContainer.appendChild(botMessageDiv);
      messagesContainer.scrollTop = messagesContainer.scrollHeight; // Scroll to bottom
    }, 500);
  }

  /**
   * Handles Enter key press in the chatbot input field.
   * @param {KeyboardEvent} event - The keyboard event.
   */
  function handleChatInput(event) {
    if (event.key === 'Enter') {
      sendChatMessage();
    }
  }

  /**
   * Provides a simulated response from the chatbot based on user input.
   * @param {string} userMessage - The user's message.
   * @returns {string} The chatbot's response.
   */
  function getBotResponse(userMessage) {
    const lowerCaseMessage = userMessage.toLowerCase();

    if (lowerCaseMessage.includes('halo') || lowerCaseMessage.includes('hai')) {
      return 'Halo! Ada yang bisa saya bantu terkait statistika?';
    } else if (lowerCaseMessage.includes('apa itu statistika')) {
      return 'Statistika adalah ilmu yang berkaitan dengan pengumpulan, pengorganisasian, analisis, interpretasi, dan presentasi data. Anda bisa membaca lebih lanjut di materi <a href="#" onclick="showMaterial(1); toggleHelpFAQModal();">Pengantar Statistika</a>.';
    } else if (lowerCaseMessage.includes('tools analisis')) {
      return 'Kami memiliki berbagai tools analisis statistik interaktif. Anda bisa melihatnya di menu <a href="#" onclick="showMaterial(8); toggleHelpFAQModal();">AnalysisTools</a>.';
    } else if (lowerCaseMessage.includes('uji t') || lowerCaseMessage.includes('t-test')) {
      return 'Uji t digunakan untuk membandingkan rata-rata satu atau dua kelompok. Anda bisa mencobanya di <a href="#" onclick="showAnalysisTool(\'uji-mean\'); toggleHelpFAQModal();">Tool Uji t</a>.';
    } else if (lowerCaseMessage.includes('anova')) {
      return 'ANOVA (Analysis of Variance) digunakan untuk membandingkan rata-rata tiga atau lebih kelompok. Coba di <a href="#" onclick="showAnalysisTool(\'anova\'); toggleHelpFAQModal();">Tool ANOVA</a>.';
    } else if (lowerCaseMessage.includes('korelasi')) {
      return 'Analisis korelasi mengukur kekuatan dan arah hubungan antara dua variabel. Anda bisa menggunakannya di <a href="#" onclick="showAnalysisTool(\'korelasi\'); toggleHelpFAQModal();">Tool Analisis Korelasi</a>.';
    } else if (lowerCaseMessage.includes('regresi')) {
      return 'Regresi linear memodelkan hubungan antara variabel dependen dan independen. Coba di <a href="#" onclick="showAnalysisTool(\'regresi\'); toggleHelpFAQModal();">Tool Analisis Regresi Linear</a>.';
    } else if (lowerCaseMessage.includes('statistik deskriptif')) {
      return 'Statistik deskriptif meringkas dan menggambarkan data. Anda bisa mencobanya di <a href="#" onclick="showAnalysisTool(\'deskriptif\'); toggleHelpFAQModal();">Tool Statistik Deskriptif</a>.';
    } else if (lowerCaseMessage.includes('uji asumsi')) {
      return 'Uji asumsi klasik meliputi normalitas, homogenitas, dan linearitas. Anda bisa mengujinya di <a href="#" onclick="showAnalysisTool(\'uji-asumsi\'); toggleHelpFAQModal();">Tool Uji Asumsi Klasik</a>.';
    } else if (lowerCaseMessage.includes('kontak') || lowerCaseMessage.includes('bantuan')) {
      return 'Anda bisa menghubungi kami melalui email: konsultasi@statistika.ac.id atau telepon: (021) 1234-5678.';
    } else if (lowerCaseMessage.includes('terima kasih')) {
      return 'Sama-sama! Senang bisa membantu.';
    } else {
      return 'Maaf, saya tidak mengerti pertanyaan Anda. Bisakah Anda bertanya dengan cara lain atau memilih topik dari menu?';
    }
  }

  // --- Admin Mode Functionality ---

  /**
   * Menutup bagian login admin.
   */
  function closeAdminLoginSection() {
    const adminLoginSection = document.getElementById('admin-login-section');
    adminLoginSection.style.display = 'none';
    document.getElementById('admin-password').value = ''; // Clear password field
    const adminToggleBtn = document.getElementById('admin-mode-toggle-btn');
    if (!isAdminMode) { // Only reset button text if not logged in
        adminToggleBtn.textContent = 'Login';
        adminToggleBtn.classList.remove('active');
    }
  }

  /**
   * Toggles the admin mode login/logout section visibility.
   */
  function toggleAdminMode() {
    const adminToggleBtn = document.getElementById('admin-mode-toggle-btn');
    const adminLoginSection = document.getElementById('admin-login-section');

    if (isAdminMode) { // If currently ON, just logout
      logoutAdmin();
    } else { // If currently OFF, toggle login form visibility
      if (adminLoginSection.style.display === 'flex') {
        closeAdminLoginSection(); // Hide if already visible
      } else {
        adminLoginSection.style.display = 'flex'; // Show login form
        adminToggleBtn.classList.add('active'); // Keep active state for visual feedback
        adminToggleBtn.textContent = 'Login'; // Ensure button text is "Login" when form is shown
      }
    }
  }

  /**
   * Handles admin login attempt.
   */
  function loginAdmin() {
    const passwordInput = document.getElementById('admin-password');
    const adminLoginSection = document.getElementById('admin-login-section');
    const adminToggleBtn = document.getElementById('admin-mode-toggle-btn');

    if (passwordInput.value === ADMIN_PASSWORD) {
      isAdminMode = true;
      document.body.classList.add('admin-active');
      document.getElementById('admin-login-form').style.display = 'none';
      document.getElementById('admin-logout-form').style.display = 'block';
      adminToggleBtn.textContent = 'Logout'; // Update button text
      enableAdminEditing();
      alert('Berhasil masuk mode Admin!');
      adminLoginSection.style.display = 'none'; // Hide login section after successful login
    } else {
      alert('Password salah!');
      passwordInput.value = '';
    }
  }

  /**
   * Handles admin logout.
   */
  function logoutAdmin() {
    isAdminMode = false;
    document.body.classList.remove('admin-active');
    document.getElementById('admin-login-form').style.display = 'block';
    document.getElementById('admin-logout-form').style.display = 'none';
    document.getElementById('admin-password').value = '';
    document.getElementById('admin-mode-toggle-btn').textContent = 'Login'; // Update button text
    document.getElementById('admin-mode-toggle-btn').classList.remove('active');
    disableAdminEditing();
    alert('Berhasil keluar dari mode Admin.');
    // Reload current page content to remove editable borders
    const currentMaterialId = document.querySelector('.material-item.active')?.dataset.materialId;
    if (currentMaterialId) {
        showMaterial(parseInt(currentMaterialId));
    } else {
        document.getElementById('pageContent').innerHTML = initialWelcomeContent;
        loadPageContentFromLocalStorage(); // Re-apply non-admin content
    }
    closeAdminLoginSection(); // Ensure the login section is hidden after logout
  }

  /**
   * Enables contenteditable for all elements with class 'editable-content'.
   */
  function enableAdminEditing() {
    document.querySelectorAll('.editable-content').forEach(el => {
      el.setAttribute('contenteditable', 'true');
      // The border is now controlled by CSS class `body.admin-active .editable-content`
      // el.style.border = '1px dashed #ff9800';
      // el.style.padding = '5px';
      // el.style.minHeight = '1.5em';
      el.addEventListener('focus', handleEditFocus);
      el.addEventListener('blur', handleEditBlur);
    });
  }

  /**
   * Disables contenteditable for all elements with class 'editable-content'.
   */
  function disableAdminEditing() {
    document.querySelectorAll('.editable-content').forEach(el => {
      el.removeAttribute('contenteditable');
      // Reset styles to default (controlled by .editable-content without admin-active)
      // el.style.border = '';
      // el.style.padding = '';
      // el.style.minHeight = '';
      el.removeEventListener('focus', handleEditFocus);
      el.removeEventListener('blur', handleEditBlur);
    });
  }

  /**
   * Stores the original content of an editable element when it gains focus.
   * @param {FocusEvent} event - The focus event.
   */
  function handleEditFocus(event) {
    currentEditableContent = event.target;
    originalContent = event.target.innerHTML;
  }

  /**
   * Saves the new content of an editable element to local storage when it loses focus.
   * @param {FocusEvent} event - The blur event.
   */
  function handleEditBlur(event) {
    const id = event.target.dataset.editableId;
    const newContent = event.target.innerHTML;

    if (id.startsWith('material-title-')) {
      const materialId = parseInt(id.replace('material-title-', ''));
      if (materialContents[materialId]) {
        materialContents[materialId].title = newContent;
        saveToLocalStorage('materialContents', materialContents);
        document.querySelector(`.material-item[data-material-id="${materialId}"] strong`).innerHTML = newContent;
      }
    } else if (id.startsWith('material-subtitle-')) {
      const materialId = parseInt(id.replace('material-subtitle-', ''));
      if (materialContents[materialId]) {
        materialContents[materialId].subtitle = newContent;
        saveToLocalStorage('materialContents', materialContents);
        document.querySelector(`.material-item[data-material-id="${materialId}"] .material-subtitle`).innerHTML = newContent;
      }
    } else if (id.startsWith('material-content-')) {
      const materialId = parseInt(id.replace('material-content-', ''));
      if (materialContents[materialId]) {
        materialContents[materialId].content = newContent;
        saveToLocalStorage('materialContents', materialContents);
      }
    } else {
      // For other general editable content on the page (header, footer,, welcome, etc.)
      const pageData = loadFromLocalStorage('pageData') || {};
      pageData[id] = newContent;
      saveToLocalStorage('pageData', pageData);
    }
    currentEditableContent = null;
    originalContent = '';
  }

  /**
   * Displays the edit form for a specific material.
   * @param {number} materialId - The ID of the material to edit.
   * @param {Event} event - The event object (to stop propagation).
   */
  function editMaterial(materialId, event) {
    event.stopPropagation(); // Prevent showMaterial from being called immediately
    if (!isAdminMode) return; // Only allow editing in admin mode

    const material = materialContents[materialId];
    if (!material) return;

    const pageContentDiv = document.getElementById('pageContent');
    pageContentDiv.innerHTML = `
      <h2>Edit Materi: <span class="editable-content" data-editable-id="material-title-${materialId}">${material.title}</span></h2>
      <p>Subtitle: <span class="editable-content" data-editable-id="material-subtitle-${materialId}">${material.subtitle}</span></p>
      <hr/>
      <h3>Konten Utama:</h3>
      <div class="editable-content" data-editable-id="material-content-${materialId}" style="min-height: 300px; border: 1px solid #ccc; padding: 10px;">
        ${material.content}
      </div>
      <div style="margin-top: 20px;">
        <button class="btn-primary save-btn" onclick="saveMaterialContent(${materialId})">Simpan Perubahan</button>
        <button class="btn-primary cancel-btn" onclick="cancelMaterialEdit()">Batal</button>
      </div>
    `;
    enableAdminEditing(); // Make the newly loaded content editable
  }

  /**
   * Saves the edited content of a material.
   * @param {number} materialId - The ID of the material to save.
   */
  function saveMaterialContent(materialId) {
    const titleEl = document.querySelector(`[data-editable-id="material-title-${materialId}"]`);
    const subtitleEl = document.querySelector(`[data-editable-id="material-subtitle-${materialId}"]`);
    const contentEl = document.querySelector(`[data-editable-id="material-content-${materialId}"]`);

    if (materialContents[materialId]) {
      materialContents[materialId].title = titleEl ? titleEl.innerHTML : materialContents[materialId].title;
      materialContents[materialId].subtitle = subtitleEl ? subtitleEl.innerHTML : materialContents[materialId].subtitle;
      materialContents[materialId].content = contentEl ? contentEl.innerHTML : materialContents[materialId].content;
      saveToLocalStorage('materialContents', materialContents);
    }

    const sidebarItem = document.querySelector(`.material-item[data-material-id="${materialId}"]`);
    if (sidebarItem) {
      sidebarItem.querySelector('strong').innerHTML = materialContents[materialId].title;
      sidebarItem.querySelector('.material-subtitle').innerHTML = materialContents[materialId].subtitle;
    }

    alert('Konten materi berhasil disimpan (secara lokal)!');
    showMaterial(materialId); // Reload the material to show saved content
  }

  /**
   * Cancels the material editing and reverts to the previous view.
   */
  function cancelMaterialEdit() {
    // Reload the welcome page or the last viewed material
    document.getElementById('pageContent').innerHTML = initialWelcomeContent;
    if (isAdminMode) {
      enableAdminEditing();
    }
    // Re-apply saved page data if any
    loadPageContentFromLocalStorage();
  }

  let nextMaterialId = 9; // Start from the next available ID

  /**
   * Adds a new material item to the sidebar and content.
   */
  function addNewMaterial() {
    if (!isAdminMode) return; // Only allow adding in admin mode

    const newId = nextMaterialId++;
    const newMaterial = {
      title: `${newId}. Materi Baru`,
      subtitle: "Deskripsi singkat materi baru",
      content: `
        <h2>${newId}. Materi Baru</h2>
        <p>Ini adalah konten untuk materi baru. Anda bisa mengeditnya di mode admin.</p>
        <p>Tambahkan informasi relevan di sini.</p>
      `
    };
    materialContents[newId] = newMaterial;
    saveToLocalStorage('materialContents', materialContents);

    const materialsNav = document.querySelector('.materials');
    const adminControls = materialsNav.querySelector('.admin-controls');

    const newMaterialItem = document.createElement('div');
    newMaterialItem.classList.add('material-item');
    newMaterialItem.setAttribute('data-material-id', newId);
    newMaterialItem.setAttribute('onclick', `showMaterial(${newId})`);
    newMaterialItem.innerHTML = `
      <strong class="editable-content" data-editable-id="material-title-${newId}">${newMaterial.title}</strong>
      <div class="material-subtitle editable-content" data-editable-id="material-subtitle-${newId}">${newMaterial.subtitle}</div>
      <button class="edit-btn" onclick="editMaterial(${newId}, event)">Edit</button>
      <button class="delete-btn" onclick="deleteMaterial(${newId}, event)">Hapus</button>
    `;
    materialsNav.insertBefore(newMaterialItem, adminControls);

    if (isAdminMode) {
      enableAdminEditingForElement(newMaterialItem.querySelector('strong'));
      enableAdminEditingForElement(newMaterialItem.querySelector('.material-subtitle'));
    }

    alert(`Materi "${newMaterial.title}" berhasil ditambahkan!`);
    showMaterial(newId); // Display the new material
  }

  /**
   * Deletes a material item.
   * @param {number} materialId - The ID of the material to delete.
   * @param {Event} event - The event object (to stop propagation).
   */
  function deleteMaterial(materialId, event) {
    event.stopPropagation(); // Prevent showMaterial from being called
    if (!isAdminMode) return; // Only allow deleting in admin mode

    if (confirm(`Apakah Anda yakin ingin menghapus materi "${materialContents[materialId].title}"?`)) {
      delete materialContents[materialId];
      saveToLocalStorage('materialContents', materialContents);
      document.querySelector(`.material-item[data-material-id="${materialId}"]`).remove();
      alert('Materi berhasil dihapus!');
      // Show welcome page or first material after deletion
      document.getElementById('pageContent').innerHTML = initialWelcomeContent;
      loadPageContentFromLocalStorage();
    }
  }

  /**
   * Enables admin editing for a specific element.
   * @param {HTMLElement} el - The element to make editable.
   */
  function enableAdminEditingForElement(el) {
    el.setAttribute('contenteditable', 'true');
    // The border is now controlled by CSS class `body.admin-active .editable-content`
    // el.style.border = '1px dashed #ff9800';
    // el.style.padding = '5px';
    // el.style.minHeight = '1.5em';
    el.addEventListener('focus', handleEditFocus);
    el.addEventListener('blur', handleEditBlur);
  }

  /**
   * Loads initial content from local storage and rebuilds the sidebar.
   */
  function loadInitialContent() {
    // Load material contents from local storage
    const storedMaterialContents = loadFromLocalStorage('materialContents');
    if (storedMaterialContents) {
      materialContents = storedMaterialContents;
      // Rebuild sidebar based on stored materials
      const materialsNav = document.querySelector('.materials');
      const adminControls = materialsNav.querySelector('.admin-controls');
      
      // Remove all existing material items to rebuild them
      materialsNav.querySelectorAll('.material-item').forEach(item => item.remove());

      // Sort material IDs numerically
      const sortedMaterialIds = Object.keys(materialContents).map(Number).sort((a, b) => a - b);

      sortedMaterialIds.forEach(id => {
        const material = materialContents[id];
        const newMaterialItem = document.createElement('div');
        newMaterialItem.classList.add('material-item');
        newMaterialItem.setAttribute('data-material-id', id);
        newMaterialItem.setAttribute('onclick', `showMaterial(${id})`);
        newMaterialItem.innerHTML = `
          <strong class="editable-content" data-editable-id="material-title-${id}">${material.title}</strong>
          <div class="material-subtitle editable-content" data-editable-id="material-subtitle-${id}">${material.subtitle}</div>
          <button class="edit-btn" onclick="editMaterial(${id}, event)">Edit</button>
          <button class="delete-btn" onclick="deleteMaterial(${id}, event)">Hapus</button>
        `;
        materialsNav.insertBefore(newMaterialItem, adminControls);
      });
      // Update nextMaterialId to ensure new materials get unique IDs
      nextMaterialId = Math.max(...Object.keys(materialContents).map(Number)) + 1;
    }

    // Load other page content from local storage
    loadPageContentFromLocalStorage();

    // Set initial welcome content after loading from storage
    initialWelcomeContent = document.getElementById('pageContent').innerHTML;
  }

  /**
   * Loads general page content (header, footer, welcome text) from local storage.
   */
  function loadPageContentFromLocalStorage() {
    const pageData = loadFromLocalStorage('pageData');
    if (pageData) {
      for (const id in pageData) {
        const el = document.querySelector(`[data-editable-id="${id}"]`);
        if (el) {
          el.innerHTML = pageData[id];
        }
      }
    }
  }

  // --- Analysis Tools Enhancements (Frontend Logic) ---

  /**
   * Parses numerical data from a textarea, handling comma or newline separators.
   * @param {string} textareaId - The ID of the textarea element.
   * @returns {number[]|null} An array of numbers or null if invalid.
   */
  function parseData(textareaId) {
    const dataString = document.getElementById(textareaId).value.trim();
    if (!dataString) {
      alert('Data tidak boleh kosong!');
      return null;
    }
    // Handle both comma-separated and newline-separated values
    const parsed = dataString.split(/[\n,]+/).map(s => parseFloat(s.trim())).filter(n => !isNaN(n));
    if (parsed.length === 0) {
        alert('Data tidak valid. Pastikan hanya angka yang dipisahkan koma atau baris baru.');
        return null;
    }
    return parsed;
  }

  /**
   * Parses multi-group data from a textarea (e.g., for ANOVA).
   * Format: "GroupName: val1, val2, val3\nGroupName2: val4, val5"
   * @param {string} textareaId - The ID of the textarea element.
   * @returns {Array<{name: string, values: number[]}>|null} An array of group objects or null if invalid.
   */
  function parseMultiGroupData(textareaId) {
    const dataString = document.getElementById(textareaId).value.trim();
    if (!dataString) {
      alert('Data tidak boleh kosong!');
      return null;
    }
    const groups = dataString.split('\n').map(line => {
      const parts = line.split(':');
      if (parts.length < 2) return null;
      const groupName = parts[0].trim();
      const values = parts[1].split(',').map(s => parseFloat(s.trim())).filter(n => !isNaN(n));
      return { name: groupName, values: values };
    }).filter(g => g && g.values.length > 0);

    if (groups.length === 0) {
      alert('Format data kelompok tidak valid. Gunakan format "NamaKelompok: val1, val2, val3" per baris.');
      return null;
    }
    return groups;
  }

  /**
   * Parses a contingency table from a textarea.
   * Format: "val1, val2\nval3, val4"
   * @param {string} textareaId - The ID of the textarea element.
   * @returns {number[][]|null} A 2D array of numbers or null if invalid.
   */
  function parseContingencyTable(textareaId) {
    const dataString = document.getElementById(textareaId).value.trim();
    if (!dataString) {
      alert('Tabel kontingensi tidak boleh kosong!');
      return null;
    }
    const rows = dataString.split('\n').map(line => {
      return line.split(',').map(s => parseInt(s.trim())).filter(n => !isNaN(n));
    }).filter(row => row.length > 0);

    if (rows.length === 0 || rows.some(row => row.length !== rows[0].length)) {
      alert('Format tabel kontingensi tidak valid. Pastikan semua baris memiliki jumlah kolom yang sama dan hanya berisi angka.');
      return null;
    }
    return rows;
  }

  /**
   * Placeholder for CSV/Excel file upload handling.
   * In a real application, this would involve a backend or a client-side library.
   * @param {string} toolId - The ID of the analysis tool.
   */
  function handleFileUpload(toolId) {
    const fileInput = document.getElementById(`dataFile_${toolId}`);
    if (fileInput.files.length > 0) {
      const file = fileInput.files[0];
      alert(`File "${file.name}" diupload. Fungsionalitas parsing file CSV/Excel memerlukan backend atau library JavaScript eksternal (misal: PapaParse untuk CSV, SheetJS untuk Excel) untuk membaca dan memproses data.`);
      // In a real application, you'd use PapaParse for CSV or SheetJS for Excel
      // For now, just simulate variable loading
      const variablesSelect = document.getElementById(`variables_${toolId}`);
      if (variablesSelect) {
        variablesSelect.innerHTML = `
          <option value="var1">Variabel A (Simulasi)</option>
          <option value="var2">Variabel B (Simulasi)</option>
          <option value="var3">Variabel C (Simulasi)</option>
        `;
      }
    }
  }

  /**
   * Toggles the visibility of input method groups (manual, sample, file) for analysis tools.
   * @param {string} toolId - The ID of the analysis tool.
   */
  function toggleInputMethod(toolId) {
    const inputMethodSelect = document.getElementById(`inputMethod_${toolId}`);
    if (!inputMethodSelect) return; // Exit if the tool doesn't have this selector

    const method = inputMethodSelect.value;
    const fileInputGroup = document.querySelector(`.file-input-group_${toolId}`);
    const manualInputGroup = document.querySelector(`.manual-input-group_${toolId}`);
    const sampleInputGroup = document.querySelector(`.sample-input-group_${toolId}`);

    if (fileInputGroup) fileInputGroup.style.display = (method === 'file' ? 'block' : 'none');
    if (manualInputGroup) manualInputGroup.style.display = (method === 'manual' ? 'block' : 'none');
    if (sampleInputGroup) sampleInputGroup.style.display = (method === 'sample' ? 'block' : 'none');

    if (method === 'sample') {
      loadSampleData(toolId);
    } else if (method === 'manual') {
        // Clear sample data if switching to manual
        const manualDataTextarea = document.getElementById(`manualData_${toolId}`);
        if (manualDataTextarea) manualDataTextarea.value = '';
        // For descriptive, clear variables select
        const variablesSelect = document.getElementById(`variables_${toolId}`);
        if (variablesSelect) variablesSelect.innerHTML = '<option value="Data">Data</option>';
        // For other tools, clear their specific textareas
        if (toolId === 'uji-mean') {
            document.getElementById('sample1_tTest').value = '';
            document.getElementById('sample2_tTest').value = '';
        } else if (toolId === 'anova') {
            document.getElementById('anovaData').value = '';
        } else if (toolId === 'korelasi') {
            document.getElementById('varX_korelasi').value = '';
            document.getElementById('varY_korelasi').value = '';
        } else if (toolId === 'regresi') {
            document.getElementById('dependentVar_regresi').value = '';
            document.getElementById('independentVar_regresi').value = '';
        } else if (toolId === 'mann-whitney') {
            document.getElementById('group1_mannwhitney').value = '';
            document.getElementById('group2_mannwhitney').value = '';
        } else if (toolId === 'chi-square') {
            document.getElementById('contingencyTable').value = '';
            document.getElementById('observedFrequencies').value = '';
            document.getElementById('expectedFrequencies').value = '';
        } else if (toolId === 'clustering') {
            document.getElementById('clusteringData').value = '';
        } else if (toolId === 'factor-analysis') {
            document.getElementById('factorAnalysisData').value = '';
        } else if (toolId === 'uji-asumsi') {
            document.getElementById('normalitasData').value = '';
            document.getElementById('homogenitasData').value = '';
        } else if (toolId === 'uji-instrumen') {
            document.getElementById('instrumentData').value = '';
        }
    }
  }

  /**
   * Loads sample data into the input fields for a given analysis tool.
   * @param {string} toolId - The ID of the analysis tool.
   */
  function loadSampleData(toolId) {
    const sampleSelect = document.getElementById(`sampleData_${toolId}`);
    if (!sampleSelect) return;

    const selectedSample = sampleSelect.value;

    if (toolId === 'deskriptif') {
      const manualDataTextarea = document.getElementById(`manualData_${toolId}`);
      const variablesSelect = document.getElementById(`variables_${toolId}`);
      let sampleData = '';
      let sampleVariables = [];

      if (selectedSample === 'sample1') {
        sampleData = '120, 150, 130, 180, 140, 160, 170, 190, 155, 165';
        sampleVariables = ['Penjualan'];
      } else if (selectedSample === 'sample2') {
        sampleData = '165, 170, 168, 175, 160, 172, 169, 178, 163, 171';
        sampleVariables = ['Tinggi'];
      }
      if (manualDataTextarea) manualDataTextarea.value = sampleData;
      if (variablesSelect) {
          variablesSelect.innerHTML = sampleVariables.map(v => `<option value="${v}">${v}</option>`).join('');
          if (sampleVariables.length > 0) {
              variablesSelect.value = sampleVariables[0];
          }
      }
    } else if (toolId === 'uji-mean') {
        const sample1Textarea = document.getElementById('sample1_tTest');
        const sample2Textarea = document.getElementById('sample2_tTest');
        const mu0Input = document.getElementById('mu0_tTest');
        const tTestTypeSelect = document.getElementById('tTestType');

        if (selectedSample === 'sample_one_sample') {
            sample1Textarea.value = '23, 45, 67, 34, 56, 78, 45, 67, 89, 23';
            mu0Input.value = '50';
            tTestTypeSelect.value = 'one-sample';
            sample2Textarea.value = ''; // Clear sample2
        } else if (selectedSample === 'sample_two_sample') {
            sample1Textarea.value = '23, 45, 67, 34, 56';
            sample2Textarea.value = '30, 50, 70, 40, 60';
            tTestTypeSelect.value = 'two-sample';
            mu0Input.value = '0'; // Reset mu0
        } else if (selectedSample === 'sample_paired') {
            sample1Textarea.value = '10, 12, 15, 11, 13';
            sample2Textarea.value = '9, 11, 14, 10, 12';
            tTestTypeSelect.value = 'paired';
            mu0Input.value = '0'; // Reset mu0
        }
        updateTTestForm(); // Update form display based on selected type
    } else if (toolId === 'anova') {
        const anovaDataTextarea = document.getElementById('anovaData');
        if (selectedSample === 'sample_one_way') {
            anovaDataTextarea.value = `Kelompok1: 23, 45, 67, 34, 56
Kelompok2: 34, 56, 78, 45, 67
Kelompok3: 45, 67, 89, 56, 78`;
        }
    } else if (toolId === 'korelasi') {
        const varXTextarea = document.getElementById('varX_korelasi');
        const varYTextarea = document.getElementById('varY_korelasi');
        if (selectedSample === 'sample_pearson') {
            varXTextarea.value = '10, 12, 15, 18, 20';
            varYTextarea.value = '25, 28, 30, 35, 38';
        }
    } else if (toolId === 'regresi') {
        const dependentVarTextarea = document.getElementById('dependentVar_regresi');
        const independentVarTextarea = document.getElementById('independentVar_regresi');
        if (selectedSample === 'sample_simple_linear') {
            dependentVarTextarea.value = '25, 28, 30, 35, 38, 40, 42, 45, 48, 50';
            independentVarTextarea.value = '10, 12, 15, 18, 20, 22, 25, 28, 30, 32';
        }
    } else if (toolId === 'mann-whitney') {
        const group1Textarea = document.getElementById('group1_mannwhitney');
        const group2Textarea = document.getElementById('group2_mannwhitney');
        if (selectedSample === 'sample_two_groups') {
            group1Textarea.value = '10, 12, 15, 11, 13';
            group2Textarea.value = '14, 16, 13, 17, 15';
        }
    } else if (toolId === 'chi-square') {
        const contingencyTableTextarea = document.getElementById('contingencyTable');
        const observedFrequenciesTextarea = document.getElementById('observedFrequencies');
        const expectedFrequenciesTextarea = document.getElementById('expectedFrequencies');
        const chiSquareTypeSelect = document.getElementById('chiSquareType');

        if (selectedSample === 'sample_independence') {
            contingencyTableTextarea.value = '10, 20\n15, 5';
            chiSquareTypeSelect.value = 'independence';
            observedFrequenciesTextarea.value = ''; // Clear other type's data
            expectedFrequenciesTextarea.value = '';
        } else if (selectedSample === 'sample_goodness_of_fit') {
            observedFrequenciesTextarea.value = '20, 30, 50';
            expectedFrequenciesTextarea.value = '25, 25, 50';
            chiSquareTypeSelect.value = 'goodness-of-fit';
            contingencyTableTextarea.value = ''; // Clear other type's data
        }
        updateChiSquareForm(); // Update form display
    } else if (toolId === 'clustering') {
        const clusteringDataTextarea = document.getElementById('clusteringData');
        if (selectedSample === 'sample_2d') {
            clusteringDataTextarea.value = '1.0, 1.1\n1.0, 1.2\n3.0, 3.1\n3.1, 3.0\n1.2, 1.0\n3.2, 3.2\n5.0, 5.1\n5.2, 5.0';
            document.getElementById('numClusters').value = '3';
        }
    } else if (toolId === 'factor-analysis') {
        const factorAnalysisDataTextarea = document.getElementById('factorAnalysisData');
        if (selectedSample === 'sample_3vars') {
            factorAnalysisDataTextarea.value = '10, 12, 11\n15, 14, 16\n20, 22, 21\n11, 13, 10\n16, 15, 17\n21, 23, 20\n12, 14, 13\n17, 16, 18\n22, 24, 23\n13, 15, 12';
            document.getElementById('numFactors').value = '1';
        }
    } else if (toolId === 'uji-asumsi') {
        const normalitasDataTextarea = document.getElementById('normalitasData');
        const homogenitasDataTextarea = document.getElementById('homogenitasData');
        const assumptionTestTypeSelect = document.getElementById('assumptionTestType');

        if (selectedSample === 'sample_normalitas') {
            normalitasDataTextarea.value = '23, 45, 67, 34, 56, 78, 45, 67, 89, 23, 50, 55, 60, 65, 70';
            assumptionTestTypeSelect.value = 'normalitas';
            homogenitasDataTextarea.value = '';
        } else if (selectedSample === 'sample_homogenitas') {
            homogenitasDataTextarea.value = 'Kelompok1: 23, 45, 67, 30, 40\nKelompok2: 34, 56, 78, 45, 55\nKelompok3: 40, 60, 80, 50, 70';
            assumptionTestTypeSelect.value = 'homogenitas';
            normalitasDataTextarea.value = '';
        }
        updateAssumptionTestForm();
    } else if (toolId === 'uji-instrumen') {
        const instrumentDataTextarea = document.getElementById('instrumentData');
        if (selectedSample === 'sample_instrument') {
            instrumentDataTextarea.value = '1, 2, 3\n2, 3, 4\n3, 4, 5\n4, 5, 4\n5, 4, 3\n1, 1, 2\n2, 2, 3\n3, 3, 4\n4, 4, 5\n5, 5, 4\n1, 2, 2\n2, 3, 3\n3, 4, 4\n4, 5, 5\n5, 4, 4';
        }
    }
  }

  // --- Placeholder functions for running analysis (will require backend integration) ---
  // These functions now include basic statistical calculations for demonstration.
  // For robust, production-ready statistics, a backend (Python/R) or a comprehensive JS library is needed.

  // Basic statistical functions (for frontend simulation)
  const calculateMean = (arr) => arr.reduce((a, b) => a + b, 0) / arr.length;
  const calculateMedian = (arr) => {
    const sorted = [...arr].sort((a, b) => a - b);
    const mid = Math.floor(sorted.length / 2);
    return sorted.length % 2 === 0 ? (sorted[mid - 1] + sorted[mid]) / 2 : sorted[mid];
  };
  const calculateMode = (arr) => {
    const counts = {};
    arr.forEach(x => { counts[x] = (counts[x] || 0) + 1; });
    let mode = [];
    let maxCount = 0;
    for (const key in counts) {
      if (counts[key] > maxCount) {
        mode = [parseFloat(key)];
        maxCount = counts[key];
      } else if (counts[key] === maxCount) {
        mode.push(parseFloat(key));
      }
    }
    return mode.join(', ');
  };
  const calculateVariance = (arr, mean) => arr.reduce((sum, x) => sum + Math.pow(x - mean, 2), 0) / (arr.length - 1);
  const calculateStdDev = (arr, mean) => Math.sqrt(calculateVariance(arr, mean));
  const calculatePearsonCorrelation = (x, y) => {
    const n = x.length;
    const meanX = calculateMean(x);
    const meanY = calculateMean(y);
    let sumXY = 0;
    let sumX2 = 0;
    let sumY2 = 0;
    for (let i = 0; i < n; i++) {
      sumXY += (x[i] - meanX) * (y[i] - meanY);
      sumX2 += Math.pow((x[i] - meanX), 2);
      sumY2 += Math.pow((y[i] - meanY), 2);
    }
    return sumXY / (Math.sqrt(sumX2) * Math.sqrt(sumY2));
  };
  // Simplified t-distribution critical value lookup (very rough approximation)
  const getTCritical = (alpha, df, twoTailed = true) => {
      // This is a highly simplified placeholder. Real t-critical values
      // depend on alpha, df, and whether it's one-tailed or two-tailed.
      // For a real application, use a statistical library or lookup table.
      if (df < 1) return Infinity;
      if (alpha === 0.05) {
          if (twoTailed) {
              if (df < 5) return 2.57; // Example values
              if (df < 10) return 2.22;
              if (df < 30) return 2.04;
              return 1.96; // Z-approx for large df
          } else { // one-tailed
              if (df < 5) return 2.13;
              if (df < 10) return 1.83;
              if (df < 30) return 1.70;
              return 1.645;
          }
      }
      if (alpha === 0.01) {
          if (twoTailed) {
              if (df < 5) return 4.03;
              if (df < 10) return 3.17;
              if (df < 30) return 2.75;
              return 2.576;
          } else { // one-tailed
              if (df < 5) return 3.36;
              if (df < 10) return 2.76;
              if (df < 30) return 2.46;
              return 2.326;
          }
      }
      return 1.96; // Default
  };

  // Simplified F-distribution critical value lookup (very rough approximation)
  const getFCritical = (alpha, df1, df2) => {
      // This is a highly simplified placeholder. Real F-critical values
      // depend on alpha, df1, and df2.
      // For a real application, use a statistical library or lookup table.
      if (df1 < 1 || df2 < 1) return Infinity;
      if (alpha === 0.05) {
          if (df1 === 1 && df2 > 30) return 4.00; // Approx for 1, inf
          if (df1 === 2 && df2 > 30) return 3.15; // Approx for 2, inf
          if (df1 === 3 && df2 > 30) return 2.68; // Approx for 3, inf
          return 3.0; // Generic rough approx
      }
      if (alpha === 0.01) {
          if (df1 === 1 && df2 > 30) return 7.08; // Approx for 1, inf
          if (df1 === 2 && df2 > 30) return 4.82; // Approx for 2, inf
          if (df1 === 3 && df2 > 30) return 4.02; // Approx for 3, inf
          return 5.0; // Generic rough approx
      }
      return 3.0; // Default
  };

  // Simplified Z-distribution critical value lookup (very rough approximation)
  const getZCritical = (alpha, twoTailed = true) => {
      if (alpha === 0.05) return twoTailed ? 1.96 : 1.645;
      if (alpha === 0.01) return twoTailed ? 2.576 : 2.326;
      if (alpha === 0.10) return twoTailed ? 1.645 : 1.28;
      return 1.96;
  };


  /**
   * Runs descriptive statistics analysis on the input data.
   */
  function runDescriptive() {
    const inputMethod = document.getElementById('inputMethod_deskriptif').value;
    let data = [];
    let selectedVariables = [];

    if (inputMethod === 'manual') {
      data = parseData('manualData_deskriptif');
      selectedVariables = ['Data'];
    } else if (inputMethod === 'sample') {
      // Ensure sample data is loaded before parsing
      loadSampleData('deskriptif'); 
      data = parseData('manualData_deskriptif');
      const sampleSelect = document.getElementById('sampleData_deskriptif');
      selectedVariables = [sampleSelect.options[sampleSelect.selectedIndex].text.split(' ')[0]];
    } else { // file upload
      alert('Fungsionalitas upload file memerlukan backend untuk parsing data.');
      document.getElementById('descriptiveResults').innerHTML = `
        <p style="color: red;">Error: Fungsionalitas upload file memerlukan backend untuk parsing data.</p>
      `;
      return;
    }

    if (!data) { // parseData already shows alert
      return;
    }
    if (data.length === 0) {
      alert('Tidak ada data yang valid untuk dianalisis.');
      return;
    }

    const n = data.length;
    const mean = calculateMean(data);
    const median = calculateMedian(data);
    const mode = calculateMode(data);
    const min = Math.min(...data);
    const max = Math.max(...data);
    const range = max - min;
    const variance = n > 1 ? calculateVariance(data, mean) : 0;
    const stdDev = n > 1 ? calculateStdDev(data, mean) : 0;

    document.getElementById('descriptiveResults').innerHTML = `
      <h4>Hasil Analisis Deskriptif untuk ${selectedVariables.join(', ')}</h4>
      <table border="1" style="width:100%; border-collapse: collapse; margin-top: 10px;">
        <tr><th>Statistik</th><th>Nilai</th></tr>
        <tr><td>Jumlah Observasi (n)</td><td>${n}</td></tr>
        <tr><td>Mean</td><td>${mean.toFixed(2)}</td></tr>
        <tr><td>Median</td><td>${median.toFixed(2)}</td></tr>
        <tr><td>Modus</td><td>${mode}</td></tr>
        <tr><td>Minimum</td><td>${min.toFixed(2)}</td></tr>
        <tr><td>Maksimum</td><td>${max.toFixed(2)}</td></tr>
        <tr><td>Range</td><td>${range.toFixed(2)}</td></tr>
        <tr><td>Varians</td><td>${variance.toFixed(2)}</td></tr>
        <tr><td>Standar Deviasi</td><td>${stdDev.toFixed(2)}</td></tr>
      </table>
      <p style="color: #4caf50; margin-top: 10px;">✓ Analisis deskriptif berhasil dijalankan! (Simulasi Frontend)</p>
    `;
  }

  /**
   * Updates the t-Test form based on the selected test type (one-sample, two-sample, paired).
   */
  function updateTTestForm() {
    const tTestType = document.getElementById('tTestType').value;
    const sample2Group = document.getElementById('sample2Group_tTest');
    const muGroup = document.getElementById('muGroup_tTest');
    
    if (tTestType === 'two-sample' || tTestType === 'paired') {
      sample2Group.style.display = 'block';
      muGroup.style.display = 'none';
    } else { // one-sample
      sample2Group.style.display = 'none';
      muGroup.style.display = 'block';
    }
  }

  /**
   * Runs the selected t-Test analysis.
   */
  function runTTest() {
    const tTestType = document.getElementById('tTestType').value;
    const alpha = parseFloat(document.getElementById('alpha').value);
    const sample1 = parseData('sample1_tTest');
    let sample2 = [];
    let mu0 = 0;

    if (!sample1 || sample1.length < 2) {
      alert('Data Sampel 1 tidak valid atau terlalu sedikit (minimal 2 observasi).');
      return;
    }

    let resultHtml = `<h4>Hasil Uji t (${tTestType})</h4>`;
    resultHtml += `<p>Tingkat Signifikansi (α): ${alpha}</p>`;

    let tStat, pValue, df;

    if (tTestType === 'one-sample') {
      mu0 = parseFloat(document.getElementById('mu0_tTest').value);
      const mean1 = calculateMean(sample1);
      const stdDev1 = calculateStdDev(sample1, mean1);
      const n1 = sample1.length;
      
      tStat = (mean1 - mu0) / (stdDev1 / Math.sqrt(n1));
      df = n1 - 1;
      // Placeholder for p-value calculation (requires t-distribution function)
      pValue = Math.random().toFixed(3); // Simulate p-value
      
      resultHtml += `<p>Hipotesis Nol (H₀): μ = ${mu0}</p>`;
      resultHtml += `<p>Hipotesis Alternatif (H₁): μ ≠ ${mu0}</p>`;
      resultHtml += `<p>Data Sampel: [${sample1.join(', ')}]</p>`;
      resultHtml += `<p>Statistik Uji t: ${tStat.toFixed(3)}</p>`;
      resultHtml += `<p>Derajat Kebebasan (df): ${df}</p>`;
      resultHtml += `<p>p-value (Simulasi): ${pValue}</p>`;

      if (parseFloat(pValue) < alpha) {
        resultHtml += `<p style="color: green;">Kesimpulan: p-value (${pValue}) < α (${alpha}). Tolak H₀. Rata-rata sampel berbeda signifikan dari ${mu0}.</p>`;
      } else {
        resultHtml += `<p style="color: red;">Kesimpulan: p-value (${pValue}) ≥ α (${alpha}). Gagal menolak H₀. Tidak ada bukti signifikan bahwa rata-rata sampel berbeda dari ${mu0}.</p>`;
      }
      resultHtml += `<p style="color: #4caf50;">✓ Uji t one-sample berhasil dijalankan! (Simulasi Frontend)</p>`;

    } else if (tTestType === 'two-sample') {
      sample2 = parseData('sample2_tTest');
      if (!sample2 || sample2.length < 2) {
        alert('Data Sampel 2 tidak valid atau terlalu sedikit (minimal 2 observasi).');
        return;
      }
      const mean1 = calculateMean(sample1);
      const stdDev1 = calculateStdDev(sample1, mean1);
      const n1 = sample1.length;
      const mean2 = calculateMean(sample2);
      const stdDev2 = calculateStdDev(sample2, mean2);
      const n2 = sample2.length;

      // Assuming unequal variances (Welch's t-test for simplicity in simulation)
      const se1 = Math.pow(stdDev1, 2) / n1;
      const se2 = Math.pow(stdDev2, 2) / n2;
      tStat = (mean1 - mean2) / Math.sqrt(se1 + se2);
      df = Math.pow(se1 + se2, 2) / (Math.pow(se1, 2) / (n1 - 1) + Math.pow(se2, 2) / (n2 - 1));
      pValue = Math.random().toFixed(3); // Simulate p-value

      resultHtml += `<p>Hipotesis Nol (H₀): μ₁ = μ₂</p>`;
      resultHtml += `<p>Hipotesis Alternatif (H₁): μ₁ ≠ μ₂</p>`;
      resultHtml += `<p>Data Sampel 1: [${sample1.join(', ')}]</p>`;
      resultHtml += `<p>Data Sampel 2: [${sample2.join(', ')}]</p>`;
      resultHtml += `<p>Statistik Uji t: ${tStat.toFixed(3)}</p>`;
      resultHtml += `<p>Derajat Kebebasan (df): ${df.toFixed(2)}</p>`;
      resultHtml += `<p>p-value (Simulasi): ${pValue}</p>`;

      if (parseFloat(pValue) < alpha) {
        resultHtml += `<p style="color: green;">Kesimpulan: p-value (${pValue}) < α (${alpha}). Tolak H₀. Ada perbedaan signifikan antara rata-rata kedua sampel.</p>`;
      } else {
        resultHtml += `<p style="color: red;">Kesimpulan: p-value (${pValue}) ≥ α (${alpha}). Gagal menolak H₀. Tidak ada perbedaan signifikan antara rata-rata kedua sampel.</p>`;
      }
      resultHtml += `<p style="color: #4caf50;">✓ Uji t two-sample berhasil dijalankan! (Simulasi Frontend)</p>`;

    } else if (tTestType === 'paired') {
      sample2 = parseData('sample2_tTest');
      if (!sample2 || sample2.length !== sample1.length || sample1.length < 2) {
        alert('Data Sampel 2 tidak valid atau jumlah observasi tidak sama dengan Sampel 1 (minimal 2 pasangan).');
        return;
      }
      const differences = sample1.map((val, i) => val - sample2[i]);
      const meanDiff = calculateMean(differences);
      const stdDevDiff = calculateStdDev(differences, meanDiff);
      const nDiff = differences.length;

      tStat = meanDiff / (stdDevDiff / Math.sqrt(nDiff));
      df = nDiff - 1;
      pValue = Math.random().toFixed(3); // Simulate p-value

      resultHtml += `<p>Hipotesis Nol (H₀): μ_d = 0 (Tidak ada perbedaan rata-rata)</p>`;
      resultHtml += `<p>Hipotesis Alternatif (H₁): μ_d ≠ 0 (Ada perbedaan rata-rata)</p>`;
      resultHtml += `<p>Data Sampel 1: [${sample1.join(', ')}]</p>`;
      resultHtml += `<p>Data Sampel 2: [${sample2.join(', ')}]</p>`;
      resultHtml += `<p>Statistik Uji t: ${tStat.toFixed(3)}</p>`;
      resultHtml += `<p>Derajat Kebebasan (df): ${df}</p>`;
      resultHtml += `<p>p-value (Simulasi): ${pValue}</p>`;

      if (parseFloat(pValue) < alpha) {
        resultHtml += `<p style="color: green;">Kesimpulan: p-value (${pValue}) < α (${alpha}). Tolak H₀. Ada perbedaan signifikan antara pasangan data.</p>`;
      } else {
        resultHtml += `<p style="color: red;">Kesimpulan: p-value (${pValue}) ≥ α (${alpha}). Gagal menolak H₀. Tidak ada perbedaan signifikan antara pasangan data.</p>`;
      }
      resultHtml += `<p style="color: #4caf50;">✓ Uji t paired berhasil dijalankan! (Simulasi Frontend)</p>`;
    }

    document.getElementById('tTestResults').innerHTML = resultHtml;
  }

  /**
   * Runs ANOVA analysis on the input data.
   */
  function runANOVA() {
    const anovaType = document.getElementById('anovaType').value;
    const alpha = parseFloat(document.getElementById('alpha_anova').value);
    const posthoc = document.getElementById('posthoc_anova').value;
    const groups = parseMultiGroupData('anovaData');

    if (!groups || groups.length < 2) {
      alert('Data kelompok tidak valid atau terlalu sedikit (minimal 2 kelompok).');
      return;
    }
    if (groups.some(g => g.values.length < 2)) {
      alert('Setiap kelompok harus memiliki minimal 2 observasi.');
      return;
    }

    let resultHtml = `<h4>Hasil Analisis ANOVA (${anovaType})</h4>`;
    resultHtml += `<p>Tingkat Signifikansi (α): ${alpha}</p>`;
    resultHtml += `<p>Hipotesis Nol (H₀): Semua rata-rata kelompok sama</p>`;
    resultHtml += `<p>Hipotesis Alternatif (H₁): Setidaknya ada satu rata-rata kelompok yang berbeda</p>`;
    resultHtml += `<p>Data Kelompok:</p><ul>`;
    groups.forEach(g => resultHtml += `<li>${g.name}: [${g.values.join(', ')}]</li>`);
    resultHtml += `</ul>`;

    // Simulate ANOVA results (requires more complex calculations for real F-stat and p-value)
    const fStat = (Math.random() * 5 + 1).toFixed(2); // F-statistic between 1 and 6
    const pValue = Math.random().toFixed(3);
    const df1 = groups.length - 1; // Degrees of freedom between groups
    const totalN = groups.reduce((sum, g) => sum + g.values.length, 0);
    const df2 = totalN - groups.length; // Degrees of freedom within groups

    resultHtml += `<p>Simulasi: F-statistik = ${fStat}, df1 = ${df1}, df2 = ${df2}, p-value = ${pValue}</p>`;

    if (parseFloat(pValue) < alpha) {
      resultHtml += `<p style="color: green;">Kesimpulan: p-value (${pValue}) < α (${alpha}). Tolak H₀. Ada perbedaan signifikan antar rata-rata kelompok.</p>`;
      if (posthoc !== 'none') {
        resultHtml += `<p>Melakukan Post-hoc Test (${posthoc})...</p>`;
        // Simulate post-hoc results
        const groupNames = groups.map(g => g.name);
        if (groupNames.length > 1) {
            const rand1 = Math.floor(Math.random() * groupNames.length);
            let rand2 = Math.floor(Math.random() * groupNames.length);
            while (rand2 === rand1) rand2 = Math.floor(Math.random() * groupNames.length);
            resultHtml += `<p>Simulasi Hasil Post-hoc: Kelompok ${groupNames[rand1]} berbeda signifikan dengan Kelompok ${groupNames[rand2]}.</p>`;
        }
      }
    } else {
      resultHtml += `<p style="color: red;">Kesimpulan: p-value (${pValue}) ≥ α (${alpha}). Gagal menolak H₀. Tidak ada perbedaan signifikan antar rata-rata kelompok.</p>`;
    }
    resultHtml += `<p style="color: #4caf50; margin-top: 10px;">✓ Analisis ANOVA berhasil dijalankan! (Simulasi Frontend)</p>`;

    document.getElementById('anovaResults').innerHTML = resultHtml;
  }

  /**
   * Runs correlation analysis on the input data.
   */
  function runCorrelation() {
    const correlationType = document.getElementById('correlationType').value;
    const alpha = parseFloat(document.getElementById('corrAlpha').value);
    const varX = parseData('varX_korelasi');
    const varY = parseData('varY_korelasi');

    if (!varX || !varY || varX.length !== varY.length || varX.length < 2) {
      alert('Data variabel X dan Y tidak valid atau jumlah observasi tidak sama (minimal 2 observasi).');
      return;
    }

    let resultHtml = `<h4>Hasil Analisis Korelasi (${correlationType})</h4>`;
    resultHtml += `<p>Tingkat Signifikansi (α): ${alpha}</p>`;
    resultHtml += `<p>Data Variabel X: [${varX.join(', ')}]</p>`;
    resultHtml += `<p>Data Variabel Y: [${varY.join(', ')}]</p>`;

    let rValue;
    if (correlationType === 'pearson') {
        rValue = calculatePearsonCorrelation(varX, varY);
    } else { // Spearman (simplified simulation)
        // Real Spearman requires ranking data, then calculating Pearson on ranks.
        rValue = (Math.random() * 2 - 1); // Simulate a value between -1 and 1
    }
    
    // Simulate p-value for correlation
    const pValue = Math.random().toFixed(3);

    resultHtml += `<p>Koefisien Korelasi (${correlationType}): ${rValue.toFixed(3)}</p>`;
    resultHtml += `<p>p-value (Simulasi): ${pValue}</p>`;

    let interpretation = '';
    if (parseFloat(pValue) < alpha) {
      interpretation += `<p style="color: green;">Kesimpulan: p-value (${pValue}) < α (${alpha}). Ada hubungan signifikan antara Variabel X dan Variabel Y.</p>`;
      if (rValue > 0) {
        interpretation += `<p>Arah hubungan: Positif. Semakin tinggi X, semakin tinggi Y.</p>`;
      } else if (rValue < 0) {
        interpretation += `<p>Arah hubungan: Negatif. Semakin tinggi X, semakin rendah Y.</p>`;
      } else {
        interpretation += `<p>Arah hubungan: Tidak ada hubungan linear yang jelas.</p>`;
      }
      interpretation += `<p>Kekuatan hubungan: `;
      const absR = Math.abs(rValue);
      if (absR >= 0.8) interpretation += `Sangat Kuat.`;
      else if (absR >= 0.6) interpretation += `Kuat.`;
      else if (absR >= 0.4) interpretation += `Sedang.`;
      else if (absR >= 0.2) interpretation += `Lemah.`;
      else interpretation += `Sangat Lemah/Tidak ada.`;
      interpretation += `</p>`;
    } else {
      interpretation += `<p style="color: red;">Kesimpulan: p-value (${pValue}) ≥ α (${alpha}). Tidak ada hubungan signifikan antara Variabel X dan Variabel Y.</p>`;
    }
    resultHtml += interpretation;
    resultHtml += `<p style="color: #4caf50; margin-top: 10px;">✓ Analisis korelasi berhasil dijalankan! (Simulasi Frontend)</p>`;

    document.getElementById('correlationResults').innerHTML = resultHtml;
  }

  /**
   * Runs linear regression analysis on the input data.
   */
  function runRegression() {
    const regressionType = document.getElementById('regressionType').value;
    const confLevel = parseFloat(document.getElementById('confLevel').value);
    const alpha = 1 - (confLevel / 100);
    const includeResiduals = document.getElementById('includeResiduals').checked;
    const dependentVar = parseData('dependentVar_regresi');
    const independentVar = parseData('independentVar_regresi');

    if (!dependentVar || !independentVar || dependentVar.length !== independentVar.length || dependentVar.length < 2) {
      alert('Data variabel dependen dan independen tidak valid atau jumlah observasi tidak sama (minimal 2 observasi).');
      return;
    }

    let resultHtml = `<h4>Hasil Analisis Regresi Linear (${regressionType})</h4>`;
    resultHtml += `<p>Confidence Level: ${confLevel}% (α = ${alpha.toFixed(2)})</p>`;
    resultHtml += `<p>Variabel Dependen (Y): [${dependentVar.join(', ')}]</p>`;
    resultHtml += `<p>Variabel Independen (X): [${independentVar.join(', ')}]</p>`;

    // Simulate simple linear regression (real calculation requires more steps)
    const n = dependentVar.length;
    const sumX = independentVar.reduce((a, b) => a + b, 0);
    const sumY = dependentVar.reduce((a, b) => a + b, 0);
    const sumXY = independentVar.map((x, i) => x * dependentVar[i]).reduce((a, b) => a + b, 0);
    const sumX2 = independentVar.map(x => x * x).reduce((a, b) => a + b, 0);

    const denominator = n * sumX2 - sumX * sumX;
    let slope = 0;
    let intercept = 0;
    if (denominator !== 0) {
        slope = (n * sumXY - sumX * sumY) / denominator;
        intercept = (sumY - slope * sumX) / n;
    } else {
        alert('Tidak dapat menghitung regresi: Variabel independen memiliki variasi nol.');
        document.getElementById('regressionResults').innerHTML = `<p style="color: red;">Error: Variabel independen memiliki variasi nol.</p>`;
        return;
    }

    const predictedY = independentVar.map(x => intercept + slope * x);
    const residuals = dependentVar.map((y, i) => y - predictedY[i]);
    const ssTotal = dependentVar.map(y => Math.pow(y - calculateMean(dependentVar), 2)).reduce((a, b) => a + b, 0);
    const ssResidual = residuals.map(r => r * r).reduce((a, b) => a + b, 0);
    const rSquared = 1 - (ssResidual / ssTotal);

    // Simulate p-value for the model (requires F-test for overall model significance)
    const pValue = Math.random().toFixed(3);

    resultHtml += `
      <h3>Model Regresi:</h3>
      <p>Persamaan Regresi: Y = ${intercept.toFixed(3)} + ${slope.toFixed(3)} * X</p>
      <p>R-squared (Koefisien Determinasi): ${rSquared.toFixed(3)}</p>
      <p>p-value (Signifikansi Model, Simulasi): ${pValue}</p>
    `;

    if (parseFloat(pValue) < alpha) {
      resultHtml += `<p style="color: green;">Kesimpulan: Model regresi signifikan secara statistik pada tingkat kepercayaan ${confLevel}%. Variabel independen (X) memiliki pengaruh signifikan terhadap variabel dependen (Y).</p>`;
      resultHtml += `<p>Interpretasi: Setiap peningkatan 1 unit pada X akan meningkatkan Y sebesar ${slope.toFixed(3)} unit.</p>`;
    } else {
      resultHtml += `<p style="color: red;">Kesimpulan: Model regresi tidak signifikan secara statistik pada tingkat kepercayaan ${confLevel}%. Variabel independen (X) tidak memiliki pengaruh signifikan terhadap variabel dependen (Y).</p>`;
    }

    if (includeResiduals) {
      const meanResidual = calculateMean(residuals);
      const stdDevResidual = calculateStdDev(residuals, meanResidual);
      resultHtml += `
        <h3>Analisis Residual:</h3>
        <p>Residual Rata-rata: ${meanResidual.toFixed(3)}</p>
        <p>Standar Deviasi Residual: ${stdDevResidual.toFixed(3)}</p>
        <p>Visualisasi residual (plot) akan ditampilkan di backend untuk pemeriksaan asumsi.</p>
      `;
    }
    resultHtml += `<p style="color: #4caf50; margin-top: 10px;">✓ Analisis regresi berhasil dijalankan! (Simulasi Frontend)</p>`;

    document.getElementById('regressionResults').innerHTML = resultHtml;
  }

  /**
   * Runs Mann-Whitney U test on the input data.
   */
  function runMannWhitney() {
    const group1 = parseData('group1_mannwhitney');
    const group2 = parseData('group2_mannwhitney');
    const alpha = parseFloat(document.getElementById('alpha_mannwhitney').value);

    if (!group1 || group1.length < 2 || !group2 || group2.length < 2) {
      alert('Data untuk kedua kelompok tidak valid atau terlalu sedikit (minimal 2 observasi per kelompok).');
      return;
    }

    let resultHtml = `<h4>Hasil Uji Mann-Whitney U</h4>`;
    resultHtml += `<p>Tingkat Signifikansi (α): ${alpha}</p>`;
    resultHtml += `<p>Data Kelompok 1: [${group1.join(', ')}]</p>`;
    resultHtml += `<p>Data Kelompok 2: [${group2.join(', ')}]</p>`;

    // Simulate Mann-Whitney U results (requires ranking and sum of ranks)
    const uStat = (Math.random() * 20 + 5).toFixed(2); // Simulate a U-statistik
    const pValue = Math.random().toFixed(3);

    resultHtml += `<p>Simulasi: U-statistik = ${uStat}, p-value = ${pValue}</p>`;

    if (parseFloat(pValue) < alpha) {
      resultHtml += `<p style="color: green;">Kesimpulan: p-value (${pValue}) < α (${alpha}). Tolak H₀. Ada perbedaan signifikan antara distribusi kedua kelompok.</p>`;
    } else {
      resultHtml += `<p style="color: red;">Kesimpulan: p-value (${pValue}) ≥ α (${alpha}). Gagal menolak H₀. Tidak ada perbedaan signifikan antara distribusi kedua kelompok.</p>`;
    }
    resultHtml += `<p style="color: #4caf50; margin-top: 10px;">✓ Uji Mann-Whitney U berhasil dijalankan! (Simulasi Frontend)</p>`;

    document.getElementById('mannWhitneyResults').innerHTML = resultHtml;
  }

  /**
   * Updates the Chi-Square form based on the selected test type (independence, goodness-of-fit).
   */
  function updateChiSquareForm() {
    const chiSquareType = document.getElementById('chiSquareType').value;
    const contingencyTableGroup = document.getElementById('contingencyTableGroup');
    const goodnessOfFitGroup = document.getElementById('goodnessOfFitGroup');

    if (contingencyTableGroup) contingencyTableGroup.style.display = (chiSquareType === 'independence' ? 'block' : 'none');
    if (goodnessOfFitGroup) goodnessOfFitGroup.style.display = (chiSquareType === 'goodness-of-fit' ? 'block' : 'none');
  }

  /**
   * Runs Chi-Square test on the input data.
   */
  function runChiSquare() {
    const chiSquareType = document.getElementById('chiSquareType').value;
    const alpha = parseFloat(document.getElementById('alpha_chiSquare').value);
    let resultHtml = `<h4>Hasil Uji Chi-Square (${chiSquareType})</h4>`;
    resultHtml += `<p>Tingkat Signifikansi (α): ${alpha}</p>`;

    let chi2Stat, pValue, df;

    if (chiSquareType === 'independence') {
      const table = parseContingencyTable('contingencyTable');
      if (!table) return;
      
      const numRows = table.length;
      const numCols = table[0].length;
      if (numRows < 2 || numCols < 2) {
          alert('Tabel kontingensi harus memiliki minimal 2 baris dan 2 kolom untuk uji independensi.');
          return;
      }

      resultHtml += `<p>Tabel Kontingensi:</p>`;
      resultHtml += `<table border="1" style="width:auto; border-collapse: collapse; margin-top: 10px;">`;
      table.forEach(row => {
        resultHtml += `<tr>${row.map(cell => `<td>${cell}</td>`).join('')}</tr>`;
      });
      resultHtml += `</table>`;
      resultHtml += `<p>Hipotesis Nol (H₀): Variabel baris dan kolom independen.</p>`;
      resultHtml += `<p>Hipotesis Alternatif (H₁): Variabel baris dan kolom tidak independen.</p>`;

      // Simulate Chi-Square calculation
      df = (numRows - 1) * (numCols - 1);
      chi2Stat = (Math.random() * 10 + 1).toFixed(2);
      pValue = Math.random().toFixed(3);

    } else { // goodness-of-fit
      const observed = parseData('observedFrequencies');
      let expected = parseData('expectedFrequencies');
      if (!observed || observed.length < 2) {
        alert('Frekuensi observasi tidak valid atau terlalu sedikit (minimal 2 kategori).');
        return;
      }
      if (expected && expected.length !== observed.length) {
        alert('Jumlah frekuensi harapan harus sama dengan frekuensi observasi.');
        return;
      }
      if (!expected || expected.every(val => val === 0)) { // If expected is not provided or all zeros, assume equal distribution
        const totalObserved = observed.reduce((sum, val) => sum + val, 0);
        expected = Array(observed.length).fill(totalObserved / observed.length);
      }
      if (expected.some(val => val <= 0)) {
          alert('Frekuensi harapan harus lebih besar dari nol.');
          return;
      }

      resultHtml += `<p>Frekuensi Observasi: [${observed.join(', ')}]</p>`;
      resultHtml += `<p>Frekuensi Harapan: [${expected.map(e => e.toFixed(2)).join(', ')}]</p>`;
      resultHtml += `<p>Hipotesis Nol (H₀): Data sesuai dengan distribusi yang diharapkan.</p>`;
      resultHtml += `<p>Hipotesis Alternatif (H₁): Data tidak sesuai dengan distribusi yang diharapkan.</p>`;

      // Simulate Chi-Square calculation
      df = observed.length - 1;
      chi2Stat = (Math.random() * 10 + 1).toFixed(2);
      pValue = Math.random().toFixed(3);
    }

    resultHtml += `<p>Simulasi: Chi-Square Statistik = ${chi2Stat}, df = ${df}, p-value = ${pValue}</p>`;

    if (parseFloat(pValue) < alpha) {
      resultHtml += `<p style="color: green;">Kesimpulan: p-value (${pValue}) < α (${alpha}). Tolak H₀. Ada hubungan signifikan (uji independensi) atau data tidak sesuai distribusi harapan (goodness of fit).</p>`;
    } else {
      resultHtml += `<p style="color: red;">Kesimpulan: p-value (${pValue}) ≥ α (${alpha}). Gagal menolak H₀. Tidak ada hubungan signifikan atau data sesuai distribusi harapan.</p>`;
    }
    resultHtml += `<p style="color: #4caf50; margin-top: 10px;">✓ Uji Chi-Square berhasil dijalankan! (Simulasi Frontend)</p>`;

    document.getElementById('chiSquareResults').innerHTML = resultHtml;
  }

  /**
   * Runs K-Means clustering on the input data.
   */
  function runClustering() {
    const dataString = document.getElementById('clusteringData').value.trim();
    const numClusters = parseInt(document.getElementById('numClusters').value);

    if (!dataString) {
      alert('Data untuk clustering tidak boleh kosong!');
      return;
    }
    const data = dataString.split('\n').map(line => {
      return line.split(',').map(s => parseFloat(s.trim())).filter(n => !isNaN(n));
    }).filter(row => row.length > 0 && row.every(val => !isNaN(val)));

    if (data.length < numClusters || data.some(row => row.length === 0)) {
      alert('Data tidak valid. Pastikan ada cukup observasi, setiap observasi memiliki fitur, dan hanya berisi angka.');
      return;
    }
    if (numClusters < 1) { // Changed from 2 to 1, as K-means can technically run with K=1, though not very useful
        alert('Jumlah kluster (K) harus minimal 1.');
        return;
    }

    let resultHtml = `<h4>Hasil K-Means Clustering</h4>`;
    resultHtml += `<p>Jumlah Kluster (K): ${numClusters}</p>`;
    resultHtml += `<p>Data Input:</p><ul>`;
    data.forEach(row => resultHtml += `<li>[${row.join(', ')}]</li>`);
    resultHtml += `</ul>`;

    // Simulate clustering results
    const assignments = data.map((_, i) => Math.floor(Math.random() * numClusters) + 1);
    const centroids = Array.from({ length: numClusters }, () => Array.from({ length: data[0].length }, () => (Math.random() * 10).toFixed(2)));

    resultHtml += `<h3>Hasil Kluster:</h3>`;
    resultHtml += `<p>Penugasan Kluster per Observasi: [${assignments.join(', ')}]</p>`;
    resultHtml += `<p>Centroid Kluster:</p><ul>`;
    centroids.forEach((c, i) => resultHtml += `<li>Kluster ${i + 1}: [${c.join(', ')}]</li>`);
    resultHtml += `</ul>`;
    resultHtml += `<p>Visualisasi kluster (scatter plot) akan ditampilkan di backend.</p>`;
    resultHtml += `<p style="color: #4caf50; margin-top: 10px;">✓ Clustering berhasil dijalankan! (Simulasi Frontend)</p>`;

    document.getElementById('clusteringResults').innerHTML = resultHtml;
  }

  /**
   * Runs Factor Analysis on the input data.
   */
  function runFactorAnalysis() {
    const dataString = document.getElementById('factorAnalysisData').value.trim();
    const numFactors = parseInt(document.getElementById('numFactors').value);

    if (!dataString) {
      alert('Data untuk analisis faktor tidak boleh kosong!');
      return;
    }
    const data = dataString.split('\n').map(line => {
      return line.split(',').map(s => parseFloat(s.trim())).filter(n => !isNaN(n));
    }).filter(row => row.length > 0 && row.every(val => !isNaN(val)));

    if (data.length < 5 || data[0].length < 2 || numFactors >= data[0].length) {
      alert('Data tidak valid. Minimal 5 observasi, 2 variabel, dan jumlah faktor harus kurang dari jumlah variabel.');
      return;
    }
    if (numFactors < 1) {
        alert('Jumlah faktor yang diekstrak harus minimal 1.');
        return;
    }

    let resultHtml = `<h4>Hasil Analisis Faktor</h4>`;
    resultHtml += `<p>Jumlah Faktor yang Diekstrak: ${numFactors}</p>`;
    resultHtml += `<p>Data Input:</p><ul>`;
    data.forEach(row => resultHtml += `<li>[${row.join(', ')}]</li>`);
    resultHtml += `</ul>`;

    // Simulate factor analysis results
    const eigenvalues = Array.from({ length: data[0].length }, () => (Math.random() * 3 + 0.5)).sort((a, b) => b - a);
    const factorLoadings = Array.from({ length: data[0].length }, (_, i) => 
      Array.from({ length: numFactors }, () => (Math.random() * 1.2 - 0.6).toFixed(3))
    );

    resultHtml += `<h3>Eigenvalues:</h3>`;
    resultHtml += `<p>[${eigenvalues.map(e => e.toFixed(2)).join(', ')}]</p>`;
    resultHtml += `<h3>Factor Loadings:</h3>`;
    resultHtml += `<table border="1" style="width:auto; border-collapse: collapse; margin-top: 10px;">`;
    resultHtml += `<tr><th>Variabel</th>${Array.from({ length: numFactors }, (_, i) => `<th>Faktor ${i + 1}</th>`).join('')}</tr>`;
    data[0].forEach((_, varIdx) => {
      resultHtml += `<tr><td>Var ${varIdx + 1}</td>${factorLoadings[varIdx].map(load => `<td>${load}</td>`).join('')}</tr>`;
    });
    resultHtml += `</table>`;
    resultHtml += `<p>Rotasi faktor (misal: Varimax) akan dilakukan di backend.</p>`;
    resultHtml += `<p style="color: #4caf50; margin-top: 10px;">✓ Analisis Faktor berhasil dijalankan! (Simulasi Frontend)</p>`;

    document.getElementById('factorAnalysisResults').innerHTML = resultHtml;
  }

  /**
   * Updates the Assumption Test form based on the selected test type.
   */
  function updateAssumptionTestForm() {
    const testType = document.getElementById('assumptionTestType').value;
    const normalitasDataGroup = document.getElementById('normalitasDataGroup');
    const homogenitasDataGroup = document.getElementById('homogenitasDataGroup');

    if (normalitasDataGroup) normalitasDataGroup.style.display = (testType === 'normalitas' ? 'block' : 'none');
    if (homogenitasDataGroup) homogenitasDataGroup.style.display = (testType === 'homogenitas' ? 'block' : 'none');
  }

  /**
   * Runs the selected Assumption Test.
   */
  function runAssumptionTest() {
    const testType = document.getElementById('assumptionTestType').value;
    const alpha = parseFloat(document.getElementById('alpha_assumption').value);
    let resultHtml = `<h4>Hasil Uji Asumsi Klasik (${testType})</h4>`;
    resultHtml += `<p>Tingkat Signifikansi (α): ${alpha}</p>`;

    const pValue = Math.random().toFixed(3);

    if (testType === 'normalitas') {
      const data = parseData('normalitasData');
      if (!data || data.length < 5) {
        alert('Data untuk uji normalitas tidak valid atau terlalu sedikit (minimal 5 observasi).');
        return;
      }
      resultHtml += `<p>Data Input: [${data.join(', ')}]</p>`;
      resultHtml += `<p>Hipotesis Nol (H₀): Data berdistribusi normal.</p>`;
      resultHtml += `<p>Hipotesis Alternatif (H₁): Data tidak berdistribusi normal.</p>`;
      resultHtml += `<p>Simulasi: Shapiro-Wilk Statistik = ${(Math.random() * 0.2 + 0.8).toFixed(3)}, p-value = ${pValue}</p>`;
      if (parseFloat(pValue) < alpha) {
        resultHtml += `<p style="color: red;">Kesimpulan: p-value (${pValue}) < α (${alpha}). Tolak H₀. Data tidak berdistribusi normal.</p>`;
      } else {
        resultHtml += `<p style="color: green;">Kesimpulan: p-value (${pValue}) ≥ α (${alpha}). Gagal menolak H₀. Data berdistribusi normal.</p>`;
      }
    } else if (testType === 'homogenitas') {
      const groups = parseMultiGroupData('homogenitasData');
      if (!groups || groups.length < 2 || groups.some(g => g.values.length < 2)) {
        alert('Data untuk uji homogenitas tidak valid atau terlalu sedikit (minimal 2 kelompok, masing-masing 2 observasi).');
        return;
      }
      resultHtml += `<p>Data Kelompok:</p><ul>`;
      groups.forEach(g => resultHtml += `<li>${g.name}: [${g.values.join(', ')}]</li>`);
      resultHtml += `</ul>`;
      resultHtml += `<p>Hipotesis Nol (H₀): Varians antar kelompok homogen.</p>`;
      resultHtml += `<p>Hipotesis Alternatif (H₁): Varians antar kelompok tidak homogen.</p>`;
      resultHtml += `<p>Simulasi: Levene's Statistik = ${(Math.random() * 5 + 0.5).toFixed(2)}, p-value = ${pValue}</p>`;
      if (parseFloat(pValue) < alpha) {
        resultHtml += `<p style="color: red;">Kesimpulan: p-value (${pValue}) < α (${alpha}). Tolak H₀. Varians antar kelompok tidak homogen.</p>`;
      } else {
        resultHtml += `<p style="color: green;">Kesimpulan: p-value (${pValue}) ≥ α (${alpha}). Gagal menolak H₀. Varians antar kelompok homogen.</p>`;
      }
    }
    resultHtml += `<p style="color: #4caf50; margin-top: 10px;">✓ Uji Asumsi berhasil dijalankan! (Simulasi Frontend)</p>`;

    document.getElementById('assumptionTestResults').innerHTML = resultHtml;
  }

  /**
   * Runs Validity & Reliability test on the input data.
   */
  function runInstrumentTest() {
    const dataString = document.getElementById('instrumentData').value.trim();
    const alpha = parseFloat(document.getElementById('alpha_validity').value);

    if (!dataString) {
      alert('Data instrumen tidak boleh kosong!');
      return;
    }
    const data = dataString.split('\n').map(line => {
      return line.split(',').map(s => parseFloat(s.trim())).filter(n => !isNaN(n));
    }).filter(row => row.length > 0 && row.every(val => !isNaN(val)));

    if (data.length < 10 || data[0].length < 2) {
      alert('Data tidak valid. Minimal 10 responden dan 2 item pertanyaan diperlukan untuk uji instrumen.');
      return;
    }

    const numItems = data[0].length;
    const numRespondents = data.length;

    let resultHtml = `<h4>Hasil Uji Validitas & Reliabilitas</h4>`;
    resultHtml += `<p>Jumlah Responden: ${numRespondents}</p>`;
    resultHtml += `<p>Jumlah Item: ${numItems}</p>`;
    resultHtml += `<p>Tingkat Signifikansi (α) untuk Validitas: ${alpha}</p>`;

    // Simulate Validity (e.g., Pearson correlation of item with total score)
    resultHtml += `<h3>Uji Validitas (Simulasi):</h3>`;
    resultHtml += `<table border="1" style="width:100%; border-collapse: collapse; margin-top: 10px;">`;
    resultHtml += `<tr><th>Item</th><th>Koefisien Korelasi (r)</th><th>p-value</th><th>Status</th></tr>`;
    for (let i = 0; i < numItems; i++) {
      const r = (Math.random() * 0.6 + 0.3).toFixed(3); // r between 0.3 and 0.9
      const p = Math.random().toFixed(3);
      const status = parseFloat(p) < alpha ? 'Valid' : 'Tidak Valid';
      resultHtml += `<tr><td>Item ${i + 1}</td><td>${r}</td><td>${p}</td><td style="color:${status === 'Valid' ? 'green' : 'red'}">${status}</td></tr>`;
    }
    resultHtml += `</table>`;
    resultHtml += `<p>Catatan: Nilai r-tabel akan dibandingkan di backend untuk penentuan validitas yang sebenarnya.</p>`;

    // Simulate Reliability (e.g., Cronbach's Alpha)
    resultHtml += `<h3>Uji Reliabilitas (Simulasi):</h3>`;
    const cronbachAlpha = (Math.random() * 0.4 + 0.6).toFixed(3); // Alpha between 0.6 and 1.0
    const reliabilityStatus = parseFloat(cronbachAlpha) >= 0.6 ? 'Reliabel' : 'Tidak Reliabel';
    resultHtml += `<p>Cronbach's Alpha: ${cronbachAlpha}</p>`;
    resultHtml += `<p style="color:${reliabilityStatus === 'Reliabel' ? 'green' : 'red'}">Kesimpulan Reliabilitas: Instrumen ${reliabilityStatus}.</p>`;
    resultHtml += `<p style="color: #4caf50; margin-top: 10px;">✓ Uji Instrumen berhasil dijalankan! (Simulasi Frontend)</p>`;

    document.getElementById('instrumentTestResults').innerHTML = resultHtml;
  }

  /**
   * Updates the Power Analysis form based on the selected test type.
   */
  function updatePowerAnalysisForm() {
    const testType = document.getElementById('powerTestType').value;
    const effectSizeLabel = document.getElementById('effectSizeLabel');
    const effectSizeHint = document.getElementById('effectSizeHint');

    if (testType === 't-test') {
        effectSizeLabel.textContent = "Ukuran Efek (Cohen's d):";
        effectSizeHint.textContent = "0.2 (kecil), 0.5 (sedang), 0.8 (besar)";
        document.getElementById('effectSize').value = 0.5;
    } else if (testType === 'anova') {
        effectSizeLabel.textContent = "Ukuran Efek (f):";
        effectSizeHint.textContent = "0.1 (kecil), 0.25 (sedang), 0.4 (besar)";
        document.getElementById('effectSize').value = 0.25;
    } else if (testType === 'correlation') {
        effectSizeLabel.textContent = "Ukuran Efek (r):";
        effectSizeHint.textContent = "0.1 (kecil), 0.3 (sedang), 0.5 (besar)";
        document.getElementById('effectSize').value = 0.3;
    } else if (testType === 'regression') {
        effectSizeLabel.textContent = "Ukuran Efek (f²):";
        effectSizeHint.textContent = "0.02 (kecil), 0.15 (sedang), 0.35 (besar)";
        document.getElementById('effectSize').value = 0.15;
    }
  }

  /**
   * Runs Power Analysis to determine required sample size or power.
   */
  function runPowerAnalysis() {
    const testType = document.getElementById('powerTestType').value;
    const effectSize = parseFloat(document.getElementById('effectSize').value);
    const alpha = parseFloat(document.getElementById('alpha_power').value);
    const desiredPower = parseFloat(document.getElementById('desiredPower').value);

    if (isNaN(effectSize) || effectSize <= 0 || isNaN(alpha) || alpha <= 0 || alpha >= 1 || isNaN(desiredPower) || desiredPower <= 0 || desiredPower >= 1) {
      alert('Input tidak valid. Pastikan semua nilai numerik diisi dengan benar dan berada dalam rentang yang sesuai (misal: alpha dan power antara 0 dan 1).');
      return;
    }

    let resultHtml = `<h4>Hasil Power Analysis (${testType})</h4>`;
    resultHtml += `<p>Ukuran Efek: ${effectSize}</p>`;
    resultHtml += `<p>Tingkat Signifikansi (α): ${alpha}</p>`;
    resultHtml += `<p>Power yang Diinginkan (1-β): ${desiredPower}</p>`;

    let requiredSampleSize = 0;
    const zAlpha = getZCritical(alpha, true); // Two-tailed for alpha
    const zBeta = getZCritical(1 - desiredPower, false); // One-tailed for beta

    if (testType === 't-test') {
        // Formula for two-sample t-test (equal n per group)
        requiredSampleSize = Math.ceil(2 * Math.pow((zAlpha + zBeta) / effectSize, 2));
        resultHtml += `<h3>Ukuran Sampel yang Dibutuhkan:</h3>`;
        resultHtml += `<p>Untuk mencapai power ${desiredPower * 100}% dengan tingkat signifikansi ${alpha * 100}% dan ukuran efek (Cohen's d) ${effectSize}, ukuran sampel minimal yang dibutuhkan per kelompok adalah sekitar <strong>${requiredSampleSize}</strong>.</p>`;
        resultHtml += `<p>Total sampel yang dibutuhkan: <strong>${requiredSampleSize * 2}</strong> (untuk dua kelompok).</p>`;
    } else if (testType === 'anova') {
        // Formula for one-way ANOVA (simplified, assumes equal group sizes)
        // This is a very rough approximation. Real ANOVA power calculation is more complex.
        const k = 3; // Assume 3 groups for simplicity
        requiredSampleSize = Math.ceil((zAlpha + zBeta) * (zAlpha + zBeta) / (effectSize * effectSize) + 1); // Simplified
        resultHtml += `<h3>Ukuran Sampel yang Dibutuhkan:</h3>`;
        resultHtml += `<p>Untuk mencapai power ${desiredPower * 100}% dengan tingkat signifikansi ${alpha * 100}% dan ukuran efek (f) ${effectSize} (dengan ${k} kelompok), ukuran sampel minimal yang dibutuhkan per kelompok adalah sekitar <strong>${requiredSampleSize}</strong>.</p>`;
        resultHtml += `<p>Total sampel yang dibutuhkan: <strong>${requiredSampleSize * k}</strong> (untuk ${k} kelompok).</p>`;
    } else if (testType === 'correlation') {
        // Formula for Pearson correlation
        requiredSampleSize = Math.ceil(Math.pow((zAlpha + zBeta) / effectSize, 2) + 3);
        resultHtml += `<h3>Ukuran Sampel yang Dibutuhkan:</h3>`;
        resultHtml += `<p>Untuk mencapai power ${desiredPower * 100}% dengan tingkat signifikansi ${alpha * 100}% dan ukuran efek (r) ${effectSize}, ukuran sampel minimal yang dibutuhkan adalah sekitar <strong>${requiredSampleSize}</strong>.</p>`;
    } else if (testType === 'regression') {
        // Formula for simple linear regression (f^2 effect size)
        // This is a very rough approximation. Real regression power calculation is more complex.
        requiredSampleSize = Math.ceil((zAlpha + zBeta) * (zAlpha + zBeta) / effectSize + 1); // Simplified
        resultHtml += `<h3>Ukuran Sampel yang Dibutuhkan:</h3>`;
        resultHtml += `<p>Untuk mencapai power ${desiredPower * 100}% dengan tingkat signifikansi ${alpha * 100}% dan ukuran efek (f²) ${effectSize}, ukuran sampel minimal yang dibutuhkan adalah sekitar <strong>${requiredSampleSize}</strong>.</p>`;
    }
    
    resultHtml += `<p style="color: #4caf50; margin-top: 10px;">✓ Power Analysis berhasil dijalankan! (Simulasi Frontend)</p>`;

    document.getElementById('powerAnalysisResults').innerHTML = resultHtml;
  }

  // --- Draggable Button Functionality ---
  /**
   * Makes an HTML element draggable.
   * @param {HTMLElement} element - The element to make draggable.
   */
  function makeDraggable(element) {
    let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
    let isDragging = false;

    element.onmousedown = dragMouseDown;
    element.ontouchstart = dragTouchStart;

    function dragMouseDown(e) {
      e = e || window.event;
      e.preventDefault();
      // get the mouse cursor position at startup:
      pos3 = e.clientX;
      pos4 = e.clientY;
      document.onmouseup = closeDragElement;
      // call a function whenever the cursor moves:
      document.onmousemove = elementDrag;
      isDragging = true;
    }

    function dragTouchStart(e) {
      e = e || window.event;
      e.preventDefault();
      const touch = e.touches[0];
      pos3 = touch.clientX;
      pos4 = touch.clientY;
      document.ontouchend = closeDragElement;
      document.ontouchmove = elementDragTouch;
      isDragging = true;
    }

    function elementDrag(e) {
      e = e || window.event;
      e.preventDefault();
      // calculate the new cursor position:
      pos1 = pos3 - e.clientX;
      pos2 = pos4 - e.clientY;
      pos3 = e.clientX;
      pos4 = e.clientY;
      // set the element's new position:
      element.style.top = (element.offsetTop - pos2) + "px";
      element.style.left = (element.offsetLeft - pos1) + "px";
    }

    function elementDragTouch(e) {
      e = e || window.event;
      e.preventDefault();
      const touch = e.touches[0];
      pos1 = pos3 - touch.clientX;
      pos2 = pos4 - touch.clientY;
      pos3 = touch.clientX;
      pos4 = touch.clientY;
      element.style.top = (element.offsetTop - pos2) + "px";
      element.style.left = (element.offsetLeft - pos1) + "px";
    }

    function closeDragElement() {
      document.onmouseup = null;
      document.onmousemove = null;
      document.ontouchend = null;
      document.ontouchmove = null;
      isDragging = false;
    }

    // Prevent click event from firing if dragging occurred
    element.addEventListener('click', function(e) {
      if (isDragging) {
        e.stopPropagation();
        isDragging = false; // Reset for next potential drag
      }
    }, true); // Use capture phase to intercept click before it reaches the handler
  }


  // --- DOMContentLoaded ---
  document.addEventListener('DOMContentLoaded', function() {
    // Load initial content and apply local storage changes
    loadInitialContent();

    // Display welcome content by default
    document.getElementById('pageContent').innerHTML = initialWelcomeContent;

    // Initialize power analysis form on load if it's the active tool
    if (document.getElementById('powerTestType')) {
        updatePowerAnalysisForm();
    }

    // Make the help-faq-btn draggable
    const helpFaqBtn = document.getElementById('help-faq-btn');
    if (helpFaqBtn) {
      makeDraggable(helpFaqBtn);
    }

    // Make the admin-mode-toggle-btn draggable
    const adminToggleBtn = document.getElementById('admin-mode-toggle-btn');
    if (adminToggleBtn) {
      makeDraggable(adminToggleBtn);
    }

    // Event listener to close admin login section when clicking outside
    document.addEventListener('click', function(event) {
        const adminLoginSection = document.getElementById('admin-login-section');
        const adminToggleBtn = document.getElementById('admin-mode-toggle-btn');

        // Check if the click is outside the login section and the toggle button
        if (adminLoginSection.style.display === 'flex' && !isAdminMode &&
            !adminLoginSection.contains(event.target) && !adminToggleBtn.contains(event.target)) {
            closeAdminLoginSection();
        }
    });
  });
</script>

</body>
</html>